"use strict";var e=require("react"),t=require("prop-types"),n=require("d3-format"),r=require("d3-time-format"),a=require("d3-scale"),s=require("d3-shape"),o=require("react-financial-charts"),i=require("d3-dsv");function l(e){var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}var c=l(e);function h(){return h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(this,arguments)}function u(e,t){let n,r;for(const t of e)null!=t&&(void 0===n?t>=t&&(n=r=t):(n>t&&(n=t),r<t&&(r=t)));return[n,r]}function d(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(n<a||void 0===n&&a>=a)&&(n=a)}return n}function p(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(n>a||void 0===n&&a>=a)&&(n=a)}return n}const m=e=>e;const f=(e,t,n)=>{let r=0,a=e.length-1;for(;a-r>1;){const s=Math.round((r+a)/2);n(e[s])<=t?r=s:a=s}const s=n(e[r]),o=n(e[a]);return(null==s?void 0:s.valueOf())===(null==t?void 0:t.valueOf())&&(a=r),(null==o?void 0:o.valueOf())===(null==t?void 0:t.valueOf())&&(r=a),s<t&&o<t&&(r=a),s>t&&o>t&&(a=r),{left:r,right:a}},g=(e,t)=>{if(e===t)return!0;if(!(e instanceof Object&&t instanceof Object))return!1;const n=Object.keys(e),r=n.length;for(let e=0;e<r;e++)if(!(n[e]in t))return!1;for(let a=0;a<r;a++)if(e[n[a]]!==t[n[a]])return!1;return r===Object.keys(t).length},v=e=>"function"==typeof e?e:()=>e;function b(e){return e&&(e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView)}const y="mouseenter.interaction",C="mouseleave.interaction",S="mousemove.pan",w="mouseup.pan",P="touchmove.pan",E="touchend.pan touchcancel.pan";function x(e){return{pageX:e.pageX,pageY:e.pageY,clientX:e.clientX,clientY:e.clientY}}function k(e,t){if(t&&e){let n;for(let r=0;r<e.length;r++)if(n=e[r],A(t(n)))return n;return}return e?e[0]:void 0}function D(e,t){const n=e?e.length:0;return n?e[n-1]:void 0}const A=e=>null!=e;function M(e){return!A(e)}function T(e,t){const n=t.currentTarget,r=n.getBoundingClientRect(),a=e.clientX-r.left-n.clientLeft,s=e.clientY-r.top-n.clientTop;return[Math.round(a),Math.round(s)]}function I(e,t){const n=e.currentTarget,r=null!=t?t:n.getBoundingClientRect(),a=e.clientX-r.left-n.clientLeft,s=e.clientY-r.top-n.clientTop;return[Math.round(a),Math.round(s)]}function _(e,t){e.forEach(e=>{e.setTransform(1,0,0,1,0,0),e.clearRect(-1,-1,e.canvas.width+2,e.canvas.height+2),e.scale(t,t)})}var O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function N(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var F=1/0,R=9007199254740991,L="[object Arguments]",H="[object Function]",j="[object GeneratorFunction]",B="object"==typeof O&&O&&O.Object===Object&&O,Y="object"==typeof self&&self&&self.Object===Object&&self,X=B||Y||Function("return this")(),W=Object.prototype,z=W.hasOwnProperty,V=W.toString,$=X.Symbol,q=W.propertyIsEnumerable,U=$?$.isConcatSpreadable:void 0;function Z(e,t,n,r,a){var s=-1,o=e.length;for(n||(n=G),a||(a=[]);++s<o;){var i=e[s];n(i)?Z(i,t-1,n,r,a):a[a.length]=i}return a}function G(e){return K(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=R}(e.length)&&!function(e){var t=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?V.call(e):"";return t==H||t==j}(e)}(e)}(e)&&z.call(e,"callee")&&(!q.call(e,"callee")||V.call(e)==L)}(e)||!!(U&&e&&e[U])}var K=Array.isArray;var J=function(e){return(e?e.length:0)?Z(e,F):[]},Q=N(J);const ee={flipYScale:!1,id:0,origin:[0,0],padding:0,yPan:!0,yPanEnabled:!1,yScale:a.scaleLinear()};function te(e){return t=>{const n=e(t);return function(e){return A(e)&&"object"==typeof e&&!Array.isArray(e)}(n)?function(e={},t=e=>e){const n=Object.keys(e),r=new Array(n.length);return n.forEach((n,a)=>{r[a]=t(e[n],n,e)}),r}(n):n}}function ne(e){if(Array.isArray(e)&&2===e.length){const[t,n]=e;return"number"==typeof t&&"number"==typeof n}return!1}function re(e,t,n=[]){return c.Children.map(t,t=>{if(!t||(void 0===(r=t.props)||void 0===r.id))return;var r;const a=Object.assign(Object.assign({},ee),t.props),{id:s,origin:o,padding:i,yExtents:l,yScale:c=ee.yScale,flipYScale:h,yExtentsCalculator:u}=a,d=c.copy(),{width:p,height:m,availableHeight:f}=function({width:e,height:t},n){return{availableHeight:t,width:e,height:n.height||t}}(e,a),{yPan:b}=a;let{yPanEnabled:y}=a;const C=l?(Array.isArray(l)?l:[l]).map(v):void 0,S=n.find(e=>e.id===s);if(ne(l))if(S&&S.yPan&&S.yPanEnabled&&b&&y&&g(S.originalYExtentsProp,l))d.domain(S.yScale.domain());else{const[e,t]=l;d.domain([e,t])}else S&&S.yPanEnabled&&(ne(S.originalYExtentsProp)||(d.domain(S.yScale.domain()),y=!0));return{id:s,origin:v(o)(p,f),padding:i,originalYExtentsProp:l,yExtents:C,yExtentsCalculator:u,flipYScale:h,yScale:d,yPan:b,yPanEnabled:y,width:p,height:m}}).filter(e=>void 0!==e)}function ae(e,t){return e.filter(e=>{const n=e.origin[1],r=n+e.height;return t[1]>n&&t[1]<r}).map(e=>e.id)}function se(e,{plotData:t,xAccessor:n,displayXAccessor:r,fullData:a},s,o,i){const l=e.map(({yExtentsCalculator:e,yExtents:i,yScale:l})=>{const c=e?e({plotData:t,xDomain:s,xAccessor:n,displayXAccessor:r,fullData:a}):function(e,t,n){const r=e.map(e=>n.map(te(e))),a=Q(r);return t.invert?u(a):[...new Set(a).values()]}(i,l,t);return{realYDomain:c,yDomainDY:void 0!==o?l.range().map(e=>e-o).map(l.invert):l.domain(),prevYDomain:l.domain()}}),c=function(){let e=m;function t(){var t;const r=arguments.length;if(0===r)return[];const a=null!==(t=p(arguments,n))&&void 0!==t?t:0,s=new Array(a);for(let t=-1;++t<a;){for(let e=-1,n=s[t]=new Array(r);++e<r;)n[e]=arguments[e][t];s[t]=e.apply(this,s[t])}return s}function n(e){return e.length}return t.combine=function(n){return arguments.length?(e=n,t):e},t}().combine((e,{realYDomain:t,yDomainDY:n,prevYDomain:r})=>{const{id:a,padding:s,height:o,yScale:l,yPan:c,flipYScale:h,yPanEnabled:u=!1}=e,d=void 0===i||i.indexOf(a)>-1,p=c&&u?d?n:r:t,m=function(e,t,n,r){if(e.rangeRoundPoints||M(e.invert)){if(isNaN(n))throw new Error("padding has to be a number for ordinal scale");e.rangeRoundPoints&&e.rangeRoundPoints(r?[0,t]:[t,0],n),e.rangeRound&&e.range(r?[0,t]:[t,0]).padding(n)}else{const{top:a,bottom:s}=isNaN(n)?n:{top:n,bottom:n};e.range(r?[a,t-s]:[t-s,a])}return e}(l.copy().domain(p),o,s,h);return Object.assign(Object.assign({},e),{yScale:m,realYDomain:t})});return c(e,l)}function oe(e,t,n,r){let a,s;if(e.invert)a=e.invert(n[0]),s=((e,t,n)=>{const{left:r,right:a}=f(e,t,n);if(r===a)return e[r];const s=n(e[r]),o=n(e[a]);return Math.abs(s.valueOf()-t.valueOf())<Math.abs(o.valueOf()-t.valueOf())?e[r]:e[a]})(r,a,t);else{const t=e.range().map((e,t)=>({x:Math.abs(e-n[0]),idx:t})).reduce((e,t)=>e.x<t.x?e:t);s=void 0!==t?r[t.idx]:r[0]}return s}var ie="http://www.w3.org/1999/xhtml",le={svg:"http://www.w3.org/2000/svg",xhtml:ie,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ce(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),le.hasOwnProperty(t)?{space:le[t],local:e}:e}function he(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===ie&&t.documentElement.namespaceURI===ie?t.createElement(e):t.createElementNS(n,e)}}function ue(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function de(e){var t=ce(e);return(t.local?ue:he)(t)}function pe(){}function me(e){return null==e?pe:function(){return this.querySelector(e)}}function fe(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function ge(){return[]}function ve(e){return function(t){return t.matches(e)}}var be=Array.prototype.find;function ye(){return this.firstElementChild}var Ce=Array.prototype.filter;function Se(){return this.children}function we(e){return new Array(e.length)}function Pe(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function Ee(e,t,n,r,a,s){for(var o,i=0,l=t.length,c=s.length;i<c;++i)(o=t[i])?(o.__data__=s[i],r[i]=o):n[i]=new Pe(e,s[i]);for(;i<l;++i)(o=t[i])&&(a[i]=o)}function xe(e,t,n,r,a,s,o){var i,l,c,h=new Map,u=t.length,d=s.length,p=new Array(u);for(i=0;i<u;++i)(l=t[i])&&(p[i]=c=o.call(l,l.__data__,i,t)+"",h.has(c)?a[i]=l:h.set(c,l));for(i=0;i<d;++i)c=o.call(e,s[i],i,s)+"",(l=h.get(c))?(r[i]=l,l.__data__=s[i],h.delete(c)):n[i]=new Pe(e,s[i]);for(i=0;i<u;++i)(l=t[i])&&h.get(p[i])===l&&(a[i]=l)}function ke(e){return e.__data__}function De(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ae(e){return function(){this.removeAttribute(e)}}function Me(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Te(e,t){return function(){this.setAttribute(e,t)}}function Ie(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function _e(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function Oe(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Ne(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Fe(e){return function(){this.style.removeProperty(e)}}function Re(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Le(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function He(e){return function(){delete this[e]}}function je(e,t){return function(){this[e]=t}}function Be(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function Ye(e){return e.trim().split(/^|\s+/)}function Xe(e){return e.classList||new We(e)}function We(e){this._node=e,this._names=Ye(e.getAttribute("class")||"")}function ze(e,t){for(var n=Xe(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function Ve(e,t){for(var n=Xe(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function $e(e){return function(){ze(this,e)}}function qe(e){return function(){Ve(this,e)}}function Ue(e,t){return function(){(t.apply(this,arguments)?ze:Ve)(this,e)}}function Ze(){this.textContent=""}function Ge(e){return function(){this.textContent=e}}function Ke(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function Je(){this.innerHTML=""}function Qe(e){return function(){this.innerHTML=e}}function et(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function tt(){this.nextSibling&&this.parentNode.appendChild(this)}function nt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function rt(){return null}function at(){var e=this.parentNode;e&&e.removeChild(this)}function st(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ot(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function it(e){return function(){var t=this.__on;if(t){for(var n,r=0,a=-1,s=t.length;r<s;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++a]=n:this.removeEventListener(n.type,n.listener,n.options);++a?t.length=a:delete this.__on}}}function lt(e,t,n){return function(){var r,a=this.__on,s=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(a)for(var o=0,i=a.length;o<i;++o)if((r=a[o]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),void(r.value=t);this.addEventListener(e.type,s,n),r={type:e.type,name:e.name,value:t,listener:s,options:n},a?a.push(r):this.__on=[r]}}function ct(e,t,n){var r=Ne(e),a=r.CustomEvent;"function"==typeof a?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function ht(e,t){return function(){return ct(this,e,t)}}function ut(e,t){return function(){return ct(this,e,t.apply(this,arguments))}}Pe.prototype={constructor:Pe,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}},We.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var dt=[null];function pt(e,t){this._groups=e,this._parents=t}function mt(e){return"string"==typeof e?new pt([[document.querySelector(e)]],[document.documentElement]):new pt([[e]],dt)}function ft(e){let t;for(;t=e.sourceEvent;)e=t;return e}function gt(e,t){if(e=ft(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}function vt(e,t){return e.target&&(e=ft(e),void 0===t&&(t=e.currentTarget),e=e.touches||[e]),Array.from(e,e=>gt(e,t))}pt.prototype={constructor:pt,select:function(e){"function"!=typeof e&&(e=me(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var s,o,i=t[a],l=i.length,c=r[a]=new Array(l),h=0;h<l;++h)(s=i[h])&&(o=e.call(s,s.__data__,h,i))&&("__data__"in s&&(o.__data__=s.__data__),c[h]=o);return new pt(r,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);return null==t?[]:fe(t)}}(e):function(e){return null==e?ge:function(){return this.querySelectorAll(e)}}(e);for(var t=this._groups,n=t.length,r=[],a=[],s=0;s<n;++s)for(var o,i=t[s],l=i.length,c=0;c<l;++c)(o=i[c])&&(r.push(e.call(o,o.__data__,c,i)),a.push(o));return new pt(r,a)},selectChild:function(e){return this.select(null==e?ye:function(e){return function(){return be.call(this.children,e)}}("function"==typeof e?e:ve(e)))},selectChildren:function(e){return this.selectAll(null==e?Se:function(e){return function(){return Ce.call(this.children,e)}}("function"==typeof e?e:ve(e)))},filter:function(e){"function"!=typeof e&&(e=function(e){return function(){return this.matches(e)}}(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var s,o=t[a],i=o.length,l=r[a]=[],c=0;c<i;++c)(s=o[c])&&e.call(s,s.__data__,c,o)&&l.push(s);return new pt(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,ke);var n,r=t?xe:Ee,a=this._parents,s=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var o=s.length,i=new Array(o),l=new Array(o),c=new Array(o),h=0;h<o;++h){var u=a[h],d=s[h],p=d.length,m=fe(e.call(u,u&&u.__data__,h,a)),f=m.length,g=l[h]=new Array(f),v=i[h]=new Array(f);r(u,d,g,v,c[h]=new Array(p),m,t);for(var b,y,C=0,S=0;C<f;++C)if(b=g[C]){for(C>=S&&(S=C+1);!(y=v[S])&&++S<f;);b._next=y||null}}return(i=new pt(i,a))._enter=l,i._exit=c,i},enter:function(){return new pt(this._enter||this._groups.map(we),this._parents)},exit:function(){return new pt(this._exit||this._groups.map(we),this._parents)},join:function(e,t,n){var r=this.enter(),a=this,s=this.exit();return r="function"==typeof e?e(r):r.append(e+""),null!=t&&(a=t(a)),null==n?s.remove():n(s),r&&a?r.merge(a).order():a},merge:function(e){if(!(e instanceof pt))throw new Error("invalid merge");for(var t=this._groups,n=e._groups,r=t.length,a=n.length,s=Math.min(r,a),o=new Array(r),i=0;i<s;++i)for(var l,c=t[i],h=n[i],u=c.length,d=o[i]=new Array(u),p=0;p<u;++p)(l=c[p]||h[p])&&(d[p]=l);for(;i<r;++i)o[i]=t[i];return new pt(o,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,a=e[t],s=a.length-1,o=a[s];--s>=0;)(r=a[s])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=De);for(var n=this._groups,r=n.length,a=new Array(r),s=0;s<r;++s){for(var o,i=n[s],l=i.length,c=a[s]=new Array(l),h=0;h<l;++h)(o=i[h])&&(c[h]=o);c.sort(t)}return new pt(a,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,s=r.length;a<s;++a){var o=r[a];if(o)return o}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a,s=t[n],o=0,i=s.length;o<i;++o)(a=s[o])&&e.call(a,a.__data__,o,s);return this},attr:function(e,t){var n=ce(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?Me:Ae:"function"==typeof t?n.local?Oe:_e:n.local?Ie:Te)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?Fe:"function"==typeof t?Le:Re)(e,t,null==n?"":n)):function(e,t){return e.style.getPropertyValue(t)||Ne(e).getComputedStyle(e,null).getPropertyValue(t)}(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?He:"function"==typeof t?Be:je)(e,t)):this.node()[e]},classed:function(e,t){var n=Ye(e+"");if(arguments.length<2){for(var r=Xe(this.node()),a=-1,s=n.length;++a<s;)if(!r.contains(n[a]))return!1;return!0}return this.each(("function"==typeof t?Ue:t?$e:qe)(n,t))},text:function(e){return arguments.length?this.each(null==e?Ze:("function"==typeof e?Ke:Ge)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?Je:("function"==typeof e?et:Qe)(e)):this.node().innerHTML},raise:function(){return this.each(tt)},lower:function(){return this.each(nt)},append:function(e){var t="function"==typeof e?e:de(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:de(e),r=null==t?rt:"function"==typeof t?t:me(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(at)},clone:function(e){return this.select(e?ot:st)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,a,s=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),o=s.length;if(!(arguments.length<2)){for(i=t?lt:it,r=0;r<o;++r)this.each(i(s[r],t,n));return this}var i=this.node().__on;if(i)for(var l,c=0,h=i.length;c<h;++c)for(r=0,l=i[c];r<o;++r)if((a=s[r]).type===l.type&&a.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?ut:ht)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,a=e[t],s=0,o=a.length;s<o;++s)(r=a[s])&&(yield r)}};var bt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};class yt extends c.Component{constructor(e){super(e),this.dx=0,this.dy=0,this.mouseInside=!1,this.mouseInteraction=!0,this.ref=c.createRef(),this.handleEnter=e=>{const{onMouseEnter:t}=this.props;if(void 0!==t){if(this.mouseInside=!0,!this.state.panInProgress&&!this.state.dragInProgress){mt(b(this.ref.current)).on(S,this.handleMouseMove)}t(e)}},this.handleLeave=e=>{const{onMouseLeave:t}=this.props;if(void 0!==t){if(this.mouseInside=!1,!this.state.panInProgress&&!this.state.dragInProgress){mt(b(this.ref.current)).on(S,null)}t(e)}},this.handleWheel=e=>{const{pan:t,onPan:n,zoom:r,onZoom:a}=this.props;if(!t&&!r)return;const{panInProgress:s}=this.state,o=Math.abs(e.deltaY)>Math.abs(e.deltaX)&&Math.abs(e.deltaY)>0,i=I(e);if(e.preventDefault(),r&&this.focus&&o&&!s){const t=e.deltaY>0?1:-1;void 0!==a&&a(t,i,e)}else if(this.focus){if(this.shouldPan()&&void 0!==this.state.panStart){const{panStartXScale:t,chartsToPan:r}=this.state.panStart;this.lastNewPos=i,this.panHappened=!0,void 0===this.dx&&(this.dx=0),void 0===this.dy&&(this.dy=0),this.dx-=e.deltaX,this.dy+=e.deltaY;const a={dx:this.dx,dy:this.dy};void 0!==n&&n(i,t,a,r,e)}else{const{xScale:e,chartConfig:t}=this.props,n=ae(t,i);this.dx=0,this.dy=0,this.setState({panInProgress:!0,panStart:{panStartXScale:e,panOrigin:i,chartsToPan:n}})}this.queuePanEnd(e)}},this.handleMouseMove=e=>{const{onMouseMove:t,mouseMove:n}=this.props;if(void 0!==t&&this.mouseInteraction&&n&&!this.state.panInProgress){t(gt(e,this.ref.current),"mouse",e)}},this.handleClick=e=>{const t=I(e),{onClick:n,onDoubleClick:r}=this.props;this.panHappened||this.dragHappened||(this.clicked&&void 0!==r?(r(t,e),this.clicked=!1):void 0!==n&&(n(t,e),this.clicked=!0,setTimeout(()=>{this.clicked&&(this.clicked=!1)},400)))},this.handleRightClick=e=>{e.stopPropagation(),e.preventDefault();const{onContextMenu:t,onPanEnd:n}=this.props,r=I(e,this.ref.current.getBoundingClientRect());if(void 0!==this.state.panStart){const{panStartXScale:t,panOrigin:[a,s],chartsToPan:o}=this.state.panStart;this.panHappened&&void 0!==n&&n(r,t,{dx:a,dy:s},o,e);mt(b(this.ref.current)).on(S,null).on(w,null),this.setState({panInProgress:!1,panStart:void 0})}void 0!==t&&t(r,e)},this.handleDrag=e=>{const{onDrag:t}=this.props;if(void 0===t)return;this.dragHappened=!0;const{dragStartPosition:n}=this.state;if(void 0===n)return;t({startPos:n,mouseXY:gt(e,this.ref.current)},e)},this.handleDragEnd=e=>{const t=gt(e,this.ref.current);if(mt(b(this.ref.current)).on(S,this.mouseInside?this.handleMouseMove:null).on(w,null),this.dragHappened){const{onDragComplete:n}=this.props;void 0!==n&&n({mouseXY:t},e)}this.setState({dragInProgress:!1}),this.mouseInteraction=!0},this.canPan=()=>{const{getAllPanConditions:e}=this.props,{pan:t}=this.props,{panEnabled:n,draggable:r}=e().reduce((e,t)=>({draggable:e.draggable||t.draggable,panEnabled:e.panEnabled&&t.panEnabled}),{draggable:!1,panEnabled:t});return{panEnabled:n,somethingSelected:r}},this.handleMouseDown=e=>{if(0!==e.button)return;const{xScale:t,chartConfig:n,onMouseDown:r}=this.props;if(this.panHappened=!1,this.dragHappened=!1,this.focus=!0,!this.state.panInProgress&&this.mouseInteraction){const a=I(e),s=ae(n,a),{panEnabled:o,somethingSelected:i}=this.canPan(),l=o&&!i;if(l){this.setState({panInProgress:l,panStart:{panStartXScale:t,panOrigin:a,chartsToPan:s}});mt(b(this.ref.current)).on(S,this.handlePan).on(w,this.handlePanEnd)}else if(i){this.setState({panInProgress:!1,dragInProgress:!0,panStart:void 0,dragStartPosition:a});const{onDragStart:t}=this.props;void 0!==t&&t({startPos:a},e);mt(b(this.ref.current)).on(S,this.handleDrag).on(w,this.handleDragEnd)}void 0!==r&&r(a,s,e)}e.preventDefault()},this.shouldPan=()=>{const{pan:e,onPan:t}=this.props;return e&&t&&void 0!==this.state.panStart},this.handlePan=e=>{if(this.shouldPan()&&void 0!==this.state.panStart){this.panHappened=!0;const{panStartXScale:t,panOrigin:n,chartsToPan:r}=this.state.panStart;let a,s,o;this.mouseInteraction?(o=gt(e,this.ref.current),this.lastNewPos=o,a=o[0]-n[0],s=o[1]-n[1]):(o=vt(e,this.ref.current)[0],this.lastNewPos=o,a=n[0]-o[0],s=n[1]-o[1]),this.dx=a,this.dy=s;const{onPan:i}=this.props;void 0!==i&&i(o,t,{dx:a,dy:s},r,e)}},this.handlePanEnd=e=>{const{pan:t,onPanEnd:n}=this.props;if(void 0!==this.state.panStart){const{panStartXScale:r,chartsToPan:a}=this.state.panStart;if(mt(b(this.ref.current)).on(S,this.mouseInside?this.handleMouseMove:null).on(w,null).on(P,null).on(E,null),this.panHappened&&t&&n){const{dx:t=0,dy:s=0}=this;delete this.dx,delete this.dy,void 0!==this.lastNewPos&&n(this.lastNewPos,r,{dx:t,dy:s},a,e)}this.setState({panInProgress:!1,panStart:void 0})}},this.handleTouchMove=e=>{const{onMouseMove:t}=this.props;if(void 0===t)return;t(T(x(e.touches[0]),e),"touch",e)},this.handleTouchStart=e=>{this.mouseInteraction=!1;const{pan:t,chartConfig:n,onMouseMove:r,xScale:a,onPanEnd:s}=this.props;if(1===e.touches.length){this.panHappened=!1;const s=T(x(e.touches[0]),e);if(void 0!==r&&r(s,"touch",e),t){const e=ae(n,s);this.setState({panInProgress:!0,panStart:{panStartXScale:a,panOrigin:s,chartsToPan:e}});mt(b(this.ref.current)).on(P,this.handlePan,!1).on(E,this.handlePanEnd,!1)}}else if(2===e.touches.length){const{panInProgress:n,panStart:r}=this.state;if(n&&t&&s&&void 0!==r){const{panStartXScale:n,panOrigin:[o,i],chartsToPan:l}=r;mt(b(this.ref.current)).on(S,this.mouseInside?this.handleMouseMove:null).on(w,null).on(P,this.handlePinchZoom,!1).on(E,this.handlePinchZoomEnd,!1);const c=T(x(e.touches[0]),e),h=T(x(e.touches[1]),e);this.panHappened&&t&&s&&void 0!==this.lastNewPos&&s(this.lastNewPos,n,{dx:o,dy:i},l,e),this.setState({panInProgress:!1,pinchZoomStart:{xScale:a,touch1Pos:c,touch2Pos:h,range:a.range(),chartsToPan:l}})}}},this.handlePinchZoom=e=>{const{pinchZoomStart:t}=this.state;if(void 0===t)return;const{xScale:n,zoom:r,onPinchZoom:a}=this.props;if(!r||void 0===a)return;const[s,o]=vt(this.ref.current),{chartsToPan:i}=t;a(bt(t,["chartsToPan"]),{touch1Pos:s,touch2Pos:o,xScale:n},e)},this.handlePinchZoomEnd=e=>{mt(b(this.ref.current)).on(P,null).on(E,null);const{pinchZoomStart:t}=this.state;if(void 0===t)return;const{chartsToPan:n}=t,r=bt(t,["chartsToPan"]),{zoom:a,onPinchZoomEnd:s}=this.props;a&&s&&s(r,e),this.setState({pinchZoomStart:void 0})},this.setCursorClass=e=>{e!==this.state.cursorOverrideClass&&this.setState({cursorOverrideClass:null===e?void 0:e})},this.focus=e.focus,this.state={panInProgress:!1}}componentDidMount(){const{disableInteraction:e}=this.props,{current:t}=this.ref;null!==t&&(e||(mt(t).on(y,this.handleEnter).on(C,this.handleLeave),t.addEventListener("wheel",this.handleWheel,{passive:!1})))}componentDidUpdate(){this.componentDidMount()}componentWillUnmount(){const{disableInteraction:e}=this.props,{current:t}=this.ref;if(null!==t&&!e){mt(t).on(y,null).on(C,null);mt(b(t)).on(S,null),t.removeEventListener("wheel",this.handleWheel,{passive:!1})}}queuePanEnd(e){void 0!==this.panEndTimeout&&window.clearTimeout(this.panEndTimeout),this.panEndTimeout=window.setTimeout(()=>{this.handlePanEnd(e)},100)}cancelDrag(){mt(b(this.ref.current)).on(S,this.mouseInside?this.handleMouseMove:null).on(w,null),this.setState({dragInProgress:!1}),this.mouseInteraction=!0}render(){const{height:e,width:t,disableInteraction:n,useCrossHairStyleCursor:r}=this.props,a=n?void 0:void 0!==this.state.cursorOverrideClass?this.state.cursorOverrideClass:r?this.state.panInProgress?"react-financial-charts-grabbing-cursor":"react-financial-charts-crosshair-cursor":void 0,s=n?void 0:{onMouseDown:this.handleMouseDown,onClick:this.handleClick,onContextMenu:this.handleRightClick,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove};return c.createElement("rect",Object.assign({ref:this.ref,className:a,width:t,height:e,style:{opacity:0}},s))}}yt.defaultProps={mouseMove:!1,zoom:!1,pan:!1,panSpeedMultiplier:1,focus:!1,disableInteraction:!1};class Ct extends c.PureComponent{constructor(){super(...arguments),this.bgRef=c.createRef(),this.axesRef=c.createRef(),this.mouseRef=c.createRef()}getCanvasContexts(){var e,t,n,r,a,s;return{bg:null!==(t=null===(e=this.bgRef.current)||void 0===e?void 0:e.getContext("2d"))&&void 0!==t?t:void 0,axes:null!==(r=null===(n=this.axesRef.current)||void 0===n?void 0:n.getContext("2d"))&&void 0!==r?r:void 0,mouseCoord:null!==(s=null===(a=this.mouseRef.current)||void 0===a?void 0:a.getContext("2d"))&&void 0!==s?s:void 0}}render(){const{height:e,ratio:t,style:n,width:r}=this.props,a=r*t,s=e*t,o={position:"absolute",width:r,height:e};return c.createElement("div",{style:Object.assign(Object.assign({},n),{position:"absolute"})},c.createElement("canvas",{ref:this.bgRef,width:a,height:s,style:o}),c.createElement("canvas",{ref:this.axesRef,width:a,height:s,style:o}),c.createElement("canvas",{ref:this.mouseRef,width:a,height:s,style:o}))}}function St(e,t,n,r){const{lastItem:a,lastItemX:s}=e,o=t(a),[i,l]=n.range();return(l-i)/(s.valueOf()-i)*(o.valueOf()-r.valueOf())+r.valueOf()}function wt(e,t,n,r,a){return{filterData:function(s,o,i,l,{currentPlotData:c,currentDomain:h,fallbackStart:u,fallbackEnd:m,ignoreThresholds:f=!1}={}){if(e)return{plotData:s,domain:o};let g=k(o),v=D(o),b=o,y=Et(s,g,v,i);1===y.length&&void 0!==u&&(g=u,v=St(m,i,l,g),b=[g,v],y=Et(s,g,v,i)),"function"==typeof t?b=t(b,[i(k(s)),i(D(s))]):("left"!==t&&"both"!==t&&!0!==t||(b=[d([g,i(k(s))]),b[1]]),"right"!==t&&"both"!==t&&!0!==t||(b=[b[0],p([v,i(D(s))])])),b!==o&&(y=Et(s,b[0],b[1],i));const C=b,S=l.copy().domain(C);let w,P,E=Math.floor(S(i(D(y)))-S(i(k(y))));a&&E<0&&(E*=-1);const x=D(S.range())-k(S.range());if(f&&y.length>1||function(e,t,n,r){const a=function(e,t){return Math.max(1,Math.ceil(e*t))}(e,r),s=Pt(e,n);return t>=a&&t<s}(E,y.length,n,r))w=y,P=C;else if(x>Pt(E,n)&&A(m)){w=y;const e=St(m,i,l,k(C));P=[k(C),e]}else w=null!=c?c:y.slice(y.length-function(e,t){return Math.floor(.97*Pt(e,t))}(E,n)),P=null!=h?h:[i(k(w)),i(D(w))];return{plotData:w,domain:P}}}}function Pt(e,t){return Math.floor(e*t)}function Et(e,t,n,r){const a=f(e,t,r).left,s=f(e,n,r).right;return e.slice(a,s+1)}const xt=["seriesName"],kt=()=>{},Dt={amIOnTop:()=>!1,chartConfigs:[],chartId:0,ratio:0,displayXAccessor:()=>0,fullData:[],getMutableState:()=>({}),height:0,margin:{top:0,right:0,bottom:0,left:0},plotData:[],setCursorClass:kt,subscribe:kt,unsubscribe:kt,redraw:kt,width:0,xAccessor:()=>0,xScale:kt},At=c.createContext(Dt),Mt=e=>{const{margin:t,height:n,width:r}=e;return{height:n-t.top-t.bottom,width:r-t.left-t.right}},Tt=e=>e?-1:1,It=e=>{const{data:t,plotFull:n,xScale:r,clamp:a,pointsPerPxThreshold:s,flipXScale:o,xAccessor:i,displayXAccessor:l,minPointsPerPxThreshold:c}=e,h=void 0!==n?n:i===m,{filterData:u}=function({xScale:e,useWholeData:t,clamp:n,pointsPerPxThreshold:r,minPointsPerPxThreshold:a,flipXScale:s}){return wt(t||M(e.invert),n,r,a,s)}({xScale:r,useWholeData:h,clamp:a,pointsPerPxThreshold:s,minPointsPerPxThreshold:c,flipXScale:o});return{xAccessor:i,displayXAccessor:null!=l?l:i,xScale:r.copy(),fullData:t,filterData:u}},_t=e=>{const t=Ot(e),{xAccessor:n,displayXAccessor:r,fullData:a,plotData:s,xScale:o}=t,{postCalculator:i,children:l}=e,c=void 0!==i?i(s):s,h=se(re(Mt(e),l),{plotData:c,xAccessor:n,displayXAccessor:r,fullData:a},o.domain());return Object.assign(Object.assign({},t),{xScale:o,plotData:c,chartConfigs:h})},Ot=e=>{const{xAccessor:t,xExtents:n,data:r,padding:a,flipXScale:s}=e,o=Tt(s),i=Mt(e),l="function"==typeof n?n(r):u(n.map(e=>v(e)).map(e=>e(r,t))),{xAccessor:c,displayXAccessor:h,xScale:d,fullData:p,filterData:m}=It(e),f=Nt(d,i,a,o),{plotData:g,domain:b}=m(p,l,t,f);return{plotData:g,xScale:f.domain(b),xAccessor:c,displayXAccessor:h,fullData:p,filterData:m}},Nt=(e,t,n,r=1)=>{if(e.rangeRoundPoints){if(isNaN(n))throw new Error("padding has to be a number for ordinal scale");e.rangeRoundPoints([0,t.width],n)}else if(e.padding){if(isNaN(n))throw new Error("padding has to be a number for ordinal scale");e.range([0,t.width]),e.padding(n/2)}else{const{left:a,right:s}=isNaN(n)?n:{left:n,right:n};r>0?e.range([a,t.width-s]):e.range([t.width-s,a])}return e},Ft=e=>{const{touch1Pos:t,touch2Pos:n}=e;return{topLeft:[Math.min(t[0],n[0]),Math.min(t[1],n[1])],bottomRight:[Math.max(t[0],n[0]),Math.max(t[1],n[1])]}},Rt=(e,t,n)=>!isNaN(e(t(k(n))))&&A(e.invert);class Lt extends c.Component{constructor(e){super(e),this.canvasContainerRef=c.createRef(),this.eventCaptureRef=c.createRef(),this.lastSubscriptionId=0,this.mutableState={mouseXY:[0,0],currentCharts:[],currentItem:null},this.panInProgress=!1,this.subscriptions=[],this.getMutableState=()=>this.mutableState,this.getCanvasContexts=()=>{var e;return null===(e=this.canvasContainerRef.current)||void 0===e?void 0:e.getCanvasContexts()},this.generateSubscriptionId=()=>(this.lastSubscriptionId++,this.lastSubscriptionId),this.subscribe=(e,t)=>{const{getPanConditions:n=v({draggable:!1,panEnabled:!0})}=t;this.subscriptions=this.subscriptions.concat(Object.assign(Object.assign({id:e},t),{getPanConditions:n}))},this.unsubscribe=e=>{this.subscriptions=this.subscriptions.filter(t=>t.id!==e)},this.getAllPanConditions=()=>this.subscriptions.map(e=>e.getPanConditions()),this.setCursorClass=e=>{var t;null===(t=this.eventCaptureRef.current)||void 0===t||t.setCursorClass(e)},this.amIOnTop=e=>{const t=this.subscriptions.filter(e=>e.getPanConditions().draggable);return t.length>0&&D(t).id===e},this.handleContextMenu=(e,t)=>{const{xAccessor:n,chartConfigs:r,plotData:a,xScale:s}=this.state,o=ae(r,e),i=oe(s,n,e,a);this.triggerEvent("contextmenu",{mouseXY:e,currentItem:i,currentCharts:o},t)},this.calculateStateForDomain=e=>{const{xAccessor:t,displayXAccessor:n,xScale:r,chartConfigs:a,plotData:s}=this.state,{filterData:o,fullData:i}=this.state,{postCalculator:l=Lt.defaultProps.postCalculator}=this.props,{plotData:c,domain:h}=o(i,e,t,r,{currentPlotData:s,currentDomain:r.domain()}),u=l(c),d=r.copy().domain(h),p=se(a,{plotData:u,xAccessor:t,displayXAccessor:n,fullData:i},d.domain());return{xScale:d,plotData:u,chartConfigs:p}},this.pinchZoomHelper=(e,t)=>{const{xScale:n}=e,{xScale:r,chartConfigs:a,plotData:s,xAccessor:o,displayXAccessor:i,filterData:l,fullData:c}=this.state,{postCalculator:h=Lt.defaultProps.postCalculator}=this.props,{topLeft:u,bottomRight:d}=Ft(e),{topLeft:p,bottomRight:m}=Ft(t),f=n.range()[1],g=Math.round(-(d[0]*p[0]-u[0]*m[0])/(u[0]-d[0])),v=Math.round(f+((f-d[0])*(f-p[0])-(f-u[0])*(f-m[0]))/(f-u[0]-(f-d[0]))),b=[Math.round(-g*u[0]/(-g+p[0])),Math.round(f-(v-f)*(f-u[0])/(v+(f-p[0])))].map(n.invert),{plotData:y,domain:C}=l(c,b,o,n,{currentPlotData:s,currentDomain:r.domain()}),S=h(y),w=r.copy().domain(C),P=t.touch1Pos;return{chartConfigs:se(a,{plotData:S,xAccessor:o,displayXAccessor:i,fullData:c},w.domain()),xScale:w,plotData:S,mouseXY:P,currentItem:oe(w,o,P,S),xAccessor:o,fullData:c}},this.handlePinchZoom=(e,t,n)=>{if(!this.waitingForPinchZoomAnimationFrame){this.waitingForPinchZoomAnimationFrame=!0;const r=this.pinchZoomHelper(e,t);this.triggerEvent("pinchzoom",r,n),this.finalPinch=t,requestAnimationFrame(()=>{this.clearBothCanvas(),this.draw({trigger:"pinchzoom"}),this.waitingForPinchZoomAnimationFrame=!1})}},this.handlePinchZoomEnd=(e,t)=>{const{xAccessor:n=Lt.defaultProps.xAccessor}=this.state;if(this.finalPinch){const r=this.pinchZoomHelper(e,this.finalPinch),{xScale:a,fullData:s}=r;this.triggerEvent("pinchzoom",r,t),this.finalPinch=void 0,this.clearThreeCanvas();const o=k(s),i=k(a.domain()),l=n(o),c=D(s),h=D(a.domain()),u=n(c),{onLoadAfter:d,onLoadBefore:p}=this.props;this.setState(r,()=>{i<l&&void 0!==p&&p(i,l),u<h&&void 0!==d&&d(u,h)})}},this.handleZoom=(e,t,n)=>{if(this.panInProgress)return;const{xAccessor:r,xScale:a,plotData:s,fullData:o}=this.state,{zoomMultiplier:i=Lt.defaultProps.zoomMultiplier,zoomAnchor:l=Lt.defaultProps.zoomAnchor}=this.props,c=l({xScale:a,xAccessor:r,mouseXY:t,plotData:s}),h=a(c),u=e>0?1*i:1/i,d=a.range().map(e=>h+(e-h)*u).map(e=>a.invert(e)),{xScale:p,plotData:m,chartConfigs:f}=this.calculateStateForDomain(d),g=oe(p,r,t,m),v=ae(f,t);this.clearThreeCanvas();const b=k(o),y=k(p.domain()),C=r(b),S=D(o),w=D(p.domain()),P=r(S);this.mutableState={mouseXY:t,currentItem:g,currentCharts:v},this.triggerEvent("zoom",{xScale:p,plotData:m,chartConfigs:f,mouseXY:t,currentCharts:v,currentItem:g,show:!0},n);const{onLoadAfter:E,onLoadBefore:x}=this.props;this.setState({xScale:p,plotData:m,chartConfigs:f},()=>{y<C&&void 0!==x&&x(y,C),P<w&&void 0!==E&&E(P,w)})},this.xAxisZoom=e=>{const{xScale:t,plotData:n,chartConfigs:r}=this.calculateStateForDomain(e);this.clearThreeCanvas();const{xAccessor:a,fullData:s}=this.state,o=k(s),i=k(t.domain()),l=a(o),c=D(s),h=D(t.domain()),u=a(c),{onLoadAfter:d,onLoadBefore:p}=this.props;this.setState({xScale:t,plotData:n,chartConfigs:r},()=>{i<l&&void 0!==p&&p(i,l),u<h&&void 0!==d&&d(u,h)})},this.yAxisZoom=(e,t)=>{this.clearThreeCanvas();const{chartConfigs:n}=this.state,r=n.map(n=>{if(n.id===e){const{yScale:e}=n;return Object.assign(Object.assign({},n),{yScale:e.copy().domain(t),yPanEnabled:!0})}return n});this.setState({chartConfigs:r})},this.draw=e=>{this.subscriptions.forEach(t=>{A(t.draw)&&t.draw(e)})},this.redraw=()=>{this.clearThreeCanvas(),this.draw({force:!0})},this.panHelper=(e,t,{dx:n,dy:r},a)=>{const{xAccessor:s,displayXAccessor:o,chartConfigs:i,filterData:l,fullData:c}=this.state,{postCalculator:h=Lt.defaultProps.postCalculator}=this.props,u=t.range().map(e=>e-n).map(e=>t.invert(e)),{plotData:d,domain:p}=l(c,u,s,t,{currentPlotData:this.hackyWayToStopPanBeyondBounds__plotData,currentDomain:this.hackyWayToStopPanBeyondBounds__domain,ignoreThresholds:!0}),m=t.copy().domain(p),f=h(d),g=oe(m,s,e,f),v=se(i,{plotData:f,xAccessor:s,displayXAccessor:o,fullData:c},m.domain(),r,a);return{xScale:m,plotData:f,chartConfigs:v,mouseXY:e,currentCharts:ae(v,e),currentItem:g}},this.handlePan=(e,t,n,r,a)=>{var s,o;if(this.waitingForPanAnimationFrame)return;this.waitingForPanAnimationFrame=!0,this.hackyWayToStopPanBeyondBounds__plotData=null!==(s=this.hackyWayToStopPanBeyondBounds__plotData)&&void 0!==s?s:this.state.plotData,this.hackyWayToStopPanBeyondBounds__domain=null!==(o=this.hackyWayToStopPanBeyondBounds__domain)&&void 0!==o?o:this.state.xScale.domain();const i=this.panHelper(e,t,n,r);this.hackyWayToStopPanBeyondBounds__plotData=i.plotData,this.hackyWayToStopPanBeyondBounds__domain=i.xScale.domain(),this.panInProgress=!0,this.triggerEvent("pan",i,a),this.mutableState={mouseXY:i.mouseXY,currentItem:i.currentItem,currentCharts:i.currentCharts},requestAnimationFrame(()=>{this.waitingForPanAnimationFrame=!1,this.clearBothCanvas(),this.draw({trigger:"pan"})})},this.handlePanEnd=(e,t,n,r,a)=>{const s=this.panHelper(e,t,n,r);this.hackyWayToStopPanBeyondBounds__plotData=null,this.hackyWayToStopPanBeyondBounds__domain=null,this.panInProgress=!1;const{xScale:o,plotData:i,chartConfigs:l}=s;this.triggerEvent("panend",s,a),requestAnimationFrame(()=>{const{xAccessor:e,fullData:t}=this.state,n=k(t),r=k(o.domain()),a=e(n),s=D(t),c=D(o.domain()),h=e(s),{onLoadAfter:u,onLoadBefore:d}=this.props;this.clearThreeCanvas(),this.setState({xScale:o,plotData:i,chartConfigs:l},()=>{r<a&&void 0!==d&&d(r,a),h<c&&void 0!==u&&u(h,c)})})},this.handleMouseDown=(e,t,n)=>{this.triggerEvent("mousedown",this.mutableState,n)},this.handleMouseEnter=e=>{this.triggerEvent("mouseenter",{show:!0},e)},this.handleMouseMove=(e,t,n)=>{if(this.waitingForMouseMoveAnimationFrame)return;this.waitingForMouseMoveAnimationFrame=!0;const{chartConfigs:r,plotData:a,xScale:s,xAccessor:o}=this.state,i=ae(r,e),l=oe(s,o,e,a);this.triggerEvent("mousemove",{show:!0,mouseXY:e,prevMouseXY:this.prevMouseXY,currentItem:l,currentCharts:i},n),this.prevMouseXY=e,this.mutableState={mouseXY:e,currentItem:l,currentCharts:i},requestAnimationFrame(()=>{this.clearMouseCanvas(),this.draw({trigger:"mousemove"}),this.waitingForMouseMoveAnimationFrame=!1})},this.handleMouseLeave=e=>{this.triggerEvent("mouseleave",{show:!1},e),this.clearMouseCanvas(),this.draw({trigger:"mouseleave"})},this.handleDragStart=({startPos:e},t)=>{this.triggerEvent("dragstart",{startPos:e},t)},this.handleDrag=({startPos:e,mouseXY:t},n)=>{const{chartConfigs:r,plotData:a,xScale:s,xAccessor:o}=this.state,i=ae(r,t),l=oe(s,o,t,a);this.triggerEvent("drag",{startPos:e,mouseXY:t,currentItem:l,currentCharts:i},n),this.mutableState={mouseXY:t,currentItem:l,currentCharts:i},requestAnimationFrame(()=>{this.clearMouseCanvas(),this.draw({trigger:"drag"})})},this.handleDragEnd=({mouseXY:e},t)=>{this.triggerEvent("dragend",{mouseXY:e},t),requestAnimationFrame(()=>{this.clearMouseCanvas(),this.draw({trigger:"dragend"})})},this.handleClick=(e,t)=>{this.triggerEvent("click",this.mutableState,t),requestAnimationFrame(()=>{this.clearMouseCanvas(),this.draw({trigger:"click"})})},this.handleDoubleClick=(e,t)=>{this.triggerEvent("dblclick",{},t)},this.resetYDomain=e=>{const{chartConfigs:t}=this.state;let n=!1;const r=t.map(t=>!M(e)&&t.id!==e||g(t.yScale.domain(),t.realYDomain)?t:(n=!0,Object.assign(Object.assign({},t),{yScale:t.yScale.domain(t.realYDomain),yPanEnabled:!1})));n&&(this.clearThreeCanvas(),this.setState({chartConfigs:r}))},this.state=_t(e)}static getDerivedStateFromProps(e,t){var n;const{chartConfigs:r,plotData:a,xAccessor:s,xScale:o}=t,i=Rt(o,s,a),l=(c=t.lastProps||{},h=e,!xt.every(e=>g(c[e],h[e])));var c,h;let u;if(i&&!l&&g(null===(n=t.lastProps)||void 0===n?void 0:n.xExtents,e.xExtents)){const[n,a]=o.domain(),s=D(t.fullData),i=It(e),{xAccessor:l}=i,c=l(s);u=((e,t,n,r,a)=>{const{fullData:s,xScale:o,xAccessor:i,displayXAccessor:l,filterData:c}=e,h=D(s),u=i(h),[d,p]=t.domain(),{postCalculator:m,children:f,padding:g,flipXScale:v,maintainPointsPerPixelOnResize:b}=n,y=Tt(v),C=Mt(n),S=Nt(o,C,g,y);let w;if(!r||p>=u){const[e,n]=t.range(),[r,a]=S.range(),o=(a-r)/(n-e)*(p.valueOf()-d.valueOf()),l=c(s,[b?p.valueOf()-o:d,p],i,S,{fallbackStart:d,fallbackEnd:{lastItem:h,lastItemX:t(u)}});w=l.plotData,S.domain(l.domain)}else if(r&&p<u){const e=t(u)-t.range()[1],[n,r]=t.range().map(t=>t+e).map(e=>t.invert(e)),a=c(s,[n,r],i,S);w=a.plotData,S.domain(a.domain)}const P=m(w),E=se(re(C,f,a),{plotData:P,xAccessor:i,displayXAccessor:l,fullData:s},S.domain());return{xScale:S,xAccessor:i,chartConfigs:E,plotData:P,fullData:s,filterData:c}})(i,o,e,c<=a&&c>=n,r)}else u=_t(e);return Object.assign(Object.assign({},u),{lastProps:e,propIteration:(t.propIteration||0)+1})}getSnapshotBeforeUpdate(e,t){return t.propIteration===this.state.propIteration||this.panInProgress||this.clearThreeCanvas(),null}componentDidUpdate(e){e.data!==this.props.data&&this.triggerEvent("dataupdated",{chartConfigs:this.state.chartConfigs,xScale:this.state.xScale,plotData:this.state.plotData})}clearBothCanvas(){const e=this.getCanvasContexts();e&&e.axes&&e.mouseCoord&&_([e.axes,e.mouseCoord],this.props.ratio)}clearMouseCanvas(){const e=this.getCanvasContexts();e&&e.mouseCoord&&_([e.mouseCoord],this.props.ratio)}clearThreeCanvas(){const e=this.getCanvasContexts();e&&e.axes&&e.mouseCoord&&e.bg&&_([e.axes,e.mouseCoord,e.bg],this.props.ratio)}cancelDrag(){var e;null===(e=this.eventCaptureRef.current)||void 0===e||e.cancelDrag(),this.triggerEvent("dragcancel")}triggerEvent(e,t,n){this.subscriptions.forEach(r=>{const a=Object.assign(Object.assign({},this.state),{subscriptions:this.subscriptions});r.listener(e,t,a,n)})}getContextValues(){const e=Mt(this.props);return{chartId:-1,fullData:this.state.fullData,plotData:this.state.plotData,width:e.width,height:e.height,chartConfigs:this.state.chartConfigs,xScale:this.state.xScale,xAccessor:this.state.xAccessor,displayXAccessor:this.state.displayXAccessor,margin:this.props.margin,ratio:this.props.ratio,xAxisZoom:this.xAxisZoom,yAxisZoom:this.yAxisZoom,getCanvasContexts:this.getCanvasContexts,redraw:this.redraw,subscribe:this.subscribe,unsubscribe:this.unsubscribe,generateSubscriptionId:this.generateSubscriptionId,getMutableState:this.getMutableState,amIOnTop:this.amIOnTop,setCursorClass:this.setCursorClass}}shouldComponentUpdate(){return!this.panInProgress}render(){const{disableInteraction:e,disablePan:t,disableZoom:n,useCrossHairStyleCursor:r,onClick:a,onDoubleClick:s,height:o,width:i,margin:l=Lt.defaultProps.margin,className:h,zIndex:u=Lt.defaultProps.zIndex,defaultFocus:d,ratio:p,mouseMoveEvent:m}=this.props,{plotData:f,xScale:g,xAccessor:v,chartConfigs:b}=this.state,y=Mt(this.props),C=Rt(g,v,f),S=r&&C,w=c.createElement("style",{type:"text/css"},"\n\t.react-financial-charts-grabbing-cursor {\n\t\tpointer-events: all;\n\t\tcursor: -moz-grabbing;\n\t\tcursor: -webkit-grabbing;\n\t\tcursor: grabbing;\n\t}\n\t.react-financial-charts-crosshair-cursor {\n\t\tpointer-events: all;\n\t\tcursor: crosshair;\n\t}\n\t.react-financial-charts-tooltip-hover {\n\t\tpointer-events: all;\n\t\tcursor: pointer;\n\t}\n\t.react-financial-charts-avoid-interaction {\n\t\tpointer-events: none;\n\t}\n\t.react-financial-charts-enable-interaction {\n\t\tpointer-events: all;\n\t}\n\t.react-financial-charts-tooltip {\n\t\tpointer-events: all;\n\t\tcursor: pointer;\n\t}\n\t.react-financial-charts-default-cursor {\n\t\tcursor: default;\n\t}\n\t.react-financial-charts-move-cursor {\n\t\tcursor: move;\n\t}\n\t.react-financial-charts-pointer-cursor {\n\t\tcursor: pointer;\n\t}\n\t.react-financial-charts-ns-resize-cursor {\n\t\tcursor: ns-resize;\n\t}\n\t.react-financial-charts-ew-resize-cursor {\n\t\tcursor: ew-resize;\n\t}");return c.createElement(At.Provider,{value:this.getContextValues()},c.createElement("div",{style:{position:"relative",width:i,height:o},className:h,onClick:a,onDoubleClick:s},c.createElement(Ct,{ref:this.canvasContainerRef,ratio:p,width:i,height:o,style:{height:o,zIndex:u,width:i}}),c.createElement("svg",{className:h,width:i,height:o,style:{position:"absolute",zIndex:u+5}},w,c.createElement("defs",null,c.createElement("clipPath",{id:"chart-area-clip"},c.createElement("rect",{x:"0",y:"0",width:y.width,height:y.height})),b.map((e,t)=>c.createElement("clipPath",{key:t,id:`chart-area-clip-${e.id}`},c.createElement("rect",{x:"0",y:"0",width:e.width,height:e.height})))),c.createElement("g",{transform:`translate(${l.left+.5}, ${l.top+.5})`},c.createElement(yt,{ref:this.eventCaptureRef,useCrossHairStyleCursor:S,mouseMove:m&&C,zoom:!n&&C,pan:!t&&C,width:y.width,height:y.height,chartConfig:b,xScale:g,xAccessor:v,focus:d,disableInteraction:e,getAllPanConditions:this.getAllPanConditions,onContextMenu:this.handleContextMenu,onClick:this.handleClick,onDoubleClick:this.handleDoubleClick,onMouseDown:this.handleMouseDown,onMouseMove:this.handleMouseMove,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onDragStart:this.handleDragStart,onDrag:this.handleDrag,onDragComplete:this.handleDragEnd,onZoom:this.handleZoom,onPinchZoom:this.handlePinchZoom,onPinchZoomEnd:this.handlePinchZoomEnd,onPan:this.handlePan,onPanEnd:this.handlePanEnd}),c.createElement("g",{className:"react-financial-charts-avoid-interaction"},this.props.children)))))}}Lt.defaultProps={clamp:!1,className:"react-financial-charts",defaultFocus:!0,disablePan:!1,disableInteraction:!1,disableZoom:!1,flipXScale:!1,maintainPointsPerPixelOnResize:!0,margin:{top:0,right:40,bottom:40,left:0},minPointsPerPxThreshold:.01,mouseMoveEvent:!0,postCalculator:m,padding:0,pointsPerPxThreshold:2,useCrossHairStyleCursor:!0,xAccessor:m,xExtents:[p,d],zIndex:1,zoomAnchor:e=>{const{xScale:t,xAccessor:n,mouseXY:r,plotData:a}=e;return n(oe(t,n,r,a))},zoomMultiplier:1.1};const Ht=c.createContext(Object.assign(Object.assign({},Dt),{chartConfig:{},chartId:0}));c.memo(e=>{const{id:t=0,onContextMenu:n,onDoubleClick:r}=e,a=c.useContext(At),{subscribe:s,unsubscribe:o,chartConfigs:i}=a,l=c.useCallback((e,a,s,o)=>{switch(e){case"contextmenu":{if(void 0===n)return;const{currentCharts:e}=a;e.indexOf(t)>-1&&n(o,a);break}case"dblclick":{if(void 0===r)return;const{currentCharts:e}=a;e.indexOf(t)>-1&&r(o,a);break}}},[n,r,t]);c.useEffect(()=>(s(`chart_${t}`,{listener:l}),()=>o(`chart_${t}`)),[s,o,t,l]);const h=i.find(({id:t})=>t===e.id),u=c.useMemo(()=>Object.assign(Object.assign({},a),{chartId:t,chartConfig:h}),[t,h,a]),{origin:[d,p]}=h;return c.createElement(Ht.Provider,{value:u},c.createElement("g",{transform:`translate(${d}, ${p})`,id:`chart_${t}`},e.children))}).displayName="Chart";const jt={mouseleave:"mousemove",panend:"pan",pinchzoom:"pan",mousedown:"mousemove",click:"mousemove",contextmenu:"mousemove",dblclick:"mousemove",dragstart:"drag",dragend:"drag",dragcancel:"drag",zoom:"zoom"};class Bt extends c.Component{constructor(e,t){super(e,t),this.moreProps={},this.dragInProgress=!1,this.evaluationInProgress=!1,this.iSetTheCursorClass=!1,this.listener=(e,t,n,r)=>{void 0!==t&&this.updateMoreProps(t),this.evaluationInProgress=!0,this.evaluateType(e,r),this.evaluationInProgress=!1},this.drawOnCanvas=this.drawOnCanvas.bind(this),this.getMoreProps=this.getMoreProps.bind(this),this.draw=this.draw.bind(this),this.updateMoreProps=this.updateMoreProps.bind(this),this.evaluateType=this.evaluateType.bind(this),this.isHover=this.isHover.bind(this),this.preCanvasDraw=this.preCanvasDraw.bind(this),this.postCanvasDraw=this.postCanvasDraw.bind(this),this.getPanConditions=this.getPanConditions.bind(this),this.shouldTypeProceed=this.shouldTypeProceed.bind(this),this.preEvaluate=this.preEvaluate.bind(this);const{generateSubscriptionId:n}=t;this.subscriberId=n(),this.state={updateCount:0}}updateMoreProps(e){Object.keys(e).forEach(t=>{this.moreProps[t]=e[t]})}shouldTypeProceed(e,t){return!0}preEvaluate(e,t,n){}evaluateType(e,t){const n=jt[e]||e;if(this.props.drawOn.indexOf(n)>-1&&(this.preEvaluate(e,this.moreProps,t),this.shouldTypeProceed(e,this.moreProps)))switch(e){case"zoom":case"mouseenter":break;case"mouseleave":this.moreProps.hovering=!1,this.props.onUnHover&&this.props.onUnHover(t,this.getMoreProps());break;case"contextmenu":this.props.onContextMenu&&this.props.onContextMenu(t,this.getMoreProps()),this.moreProps.hovering&&this.props.onContextMenuWhenHover&&this.props.onContextMenuWhenHover(t,this.getMoreProps());break;case"mousedown":this.props.onMouseDown&&this.props.onMouseDown(t,this.getMoreProps());break;case"click":{const{onClick:e,onClickOutside:n,onClickWhenHover:r}=this.props,a=this.getMoreProps();a.hovering&&void 0!==r?r(t,a):void 0!==n&&n(t,a),void 0!==e&&e(t,a);break}case"mousemove":{const e=this.moreProps.hovering;this.moreProps.hovering=this.isHover(t);const{amIOnTop:n,setCursorClass:r}=this.context;this.moreProps.hovering&&!this.props.selected&&n(this.subscriberId)&&void 0!==this.props.onHover?(r("react-financial-charts-pointer-cursor"),this.iSetTheCursorClass=!0):this.moreProps.hovering&&this.props.selected&&n(this.subscriberId)?(r(this.props.interactiveCursorClass),this.iSetTheCursorClass=!0):e&&!this.moreProps.hovering&&this.iSetTheCursorClass&&(this.iSetTheCursorClass=!1,r(null));const a=this.getMoreProps();this.moreProps.hovering&&!e&&this.props.onHover&&this.props.onHover(t,a),e&&!this.moreProps.hovering&&this.props.onUnHover&&this.props.onUnHover(t,a),this.props.onMouseMove&&this.props.onMouseMove(t,a);break}case"dblclick":{const e=this.getMoreProps();this.props.onDoubleClick&&this.props.onDoubleClick(t,e),this.moreProps.hovering&&this.props.onDoubleClickWhenHover&&this.props.onDoubleClickWhenHover(t,e);break}case"pan":this.moreProps.hovering=!1,this.props.onPan&&this.props.onPan(t,this.getMoreProps());break;case"panend":this.props.onPanEnd&&this.props.onPanEnd(t,this.getMoreProps());break;case"dragstart":if(this.getPanConditions().draggable){const{amIOnTop:e}=this.context;e(this.subscriberId)&&(this.dragInProgress=!0,void 0!==this.props.onDragStart&&this.props.onDragStart(t,this.getMoreProps()))}break;case"drag":this.dragInProgress&&this.props.onDrag&&this.props.onDrag(t,this.getMoreProps());break;case"dragend":this.dragInProgress&&this.props.onDragComplete&&this.props.onDragComplete(t,this.getMoreProps()),this.dragInProgress=!1;break;case"dragcancel":if(this.dragInProgress||this.iSetTheCursorClass){const{setCursorClass:e}=this.context;e(null)}}}isHover(e){const{isHover:t}=this.props;return void 0!==t&&t(this.getMoreProps(),e)}getPanConditions(){return{draggable:!(!this.props.selected||!this.moreProps.hovering)||this.props.enableDragOnHover&&this.moreProps.hovering,panEnabled:!this.props.disablePan}}draw({trigger:e,force:t=!1}){const n=jt[e]||e;if(this.props.drawOn.indexOf(n)>-1||this.props.selected||t){const{canvasDraw:e}=this.props;if(void 0===e){const{updateCount:e}=this.state;this.setState({updateCount:e+1})}else this.drawOnCanvas()}}UNSAFE_componentWillMount(){const{subscribe:e,chartId:t}=this.context,{clip:n,edgeClip:r}=this.props;e(this.subscriberId,{chartId:t,clip:n,edgeClip:r,listener:this.listener,draw:this.draw,getPanConditions:this.getPanConditions}),this.UNSAFE_componentWillReceiveProps(this.props,this.context)}componentWillUnmount(){const{unsubscribe:e}=this.context;if(e(this.subscriberId),this.iSetTheCursorClass){const{setCursorClass:e}=this.context;e(null)}}componentDidMount(){this.componentDidUpdate(this.props)}componentDidUpdate(e){const{canvasDraw:t,selected:n,interactiveCursorClass:r}=this.props;if(e.selected!==n){const{setCursorClass:e}=this.context;n&&this.moreProps.hovering?(this.iSetTheCursorClass=!0,e(r)):(this.iSetTheCursorClass=!1,e(null))}void 0===t||this.evaluationInProgress||(this.updateMoreProps(this.moreProps),this.drawOnCanvas())}UNSAFE_componentWillReceiveProps(e,t){const{xScale:n,plotData:r,chartConfig:a,getMutableState:s}=t;this.moreProps=Object.assign(Object.assign(Object.assign({},this.moreProps),s()),{xScale:n,plotData:r,chartConfig:a})}getMoreProps(){const{xScale:e,plotData:t,chartConfigs:n,morePropsDecorator:r,xAccessor:a,displayXAccessor:s,width:o,height:i}=this.context,{chartId:l,fullData:c}=this.context,h=Object.assign({xScale:e,plotData:t,chartConfigs:n,xAccessor:a,displayXAccessor:s,width:o,height:i,chartId:l,fullData:c},this.moreProps);return(r||m)(h)}preCanvasDraw(e,t){}postCanvasDraw(e,t){}drawOnCanvas(){const{canvasDraw:e,canvasToDraw:t}=this.props;if(void 0===e||void 0===t)return;const{getCanvasContexts:n}=this.context,r=this.getMoreProps(),a=t(n());void 0!==a&&(this.preCanvasDraw(a,r),e(a,r),this.postCanvasDraw(a,r))}render(){const{canvasDraw:e,clip:t,svgDraw:n}=this.props;if(void 0!==e||void 0===n)return null;const{chartId:r}=this.context,a=t?{clipPath:`url(#chart-area-clip${void 0!==r?"-"+r:""})`}:void 0;return c.createElement("g",{style:a},n(this.getMoreProps()))}}Bt.defaultProps={svgDraw:v(null),draw:[],canvasToDraw:e=>e.mouseCoord,clip:!0,edgeClip:!1,selected:!1,disablePan:!1,enableDragOnHover:!1},Bt.contextType=At;const Yt=["drag","dragend"];class Xt extends Bt{constructor(e,t){super(e,t),this.preCanvasDraw=this.preCanvasDraw.bind(this),this.postCanvasDraw=this.postCanvasDraw.bind(this),this.shouldTypeProceed=this.shouldTypeProceed.bind(this),this.preEvaluate=this.preEvaluate.bind(this),this.updateMoreProps=this.updateMoreProps.bind(this)}preCanvasDraw(e,t){super.preCanvasDraw(e,t),e.save();const{margin:n,ratio:r}=this.context,{chartConfig:{width:a,height:s,origin:o}}=t,i=.5*r+o[0]+n.left,l=.5*r+o[1]+n.top,{clip:c,edgeClip:h}=this.props;e.setTransform(1,0,0,1,0,0),e.scale(r,r),h&&(e.beginPath(),e.rect(-1,l-10,a+n.left+n.right+1,s+20),e.clip()),e.translate(i,l),c&&(e.beginPath(),e.rect(-1,-1,a+1,s+1),e.clip())}postCanvasDraw(e,t){super.postCanvasDraw(e,t),e.restore()}updateMoreProps(e){super.updateMoreProps(e);const{chartConfig:t}=e;if(t&&Array.isArray(t)){const{chartId:e}=this.context,n=t.find(t=>t.id===e);this.moreProps.chartConfig=n}if(A(this.moreProps.chartConfig)){const{origin:[t,n]}=this.moreProps.chartConfig;if(A(e.mouseXY)){const{mouseXY:[r,a]}=e;this.moreProps.mouseXY=[r-t,a-n]}if(A(e.startPos)){const{startPos:[r,a]}=e;this.moreProps.startPos=[r-t,a-n]}}}preEvaluate(){}shouldTypeProceed(e,t){return!("mousemove"!==e&&"click"!==e||!this.props.disablePan)||(-1!==Yt.indexOf(e)||!A(t)||!A(t.currentCharts)||t.currentCharts.indexOf(this.context.chartId)>-1)}}Xt.defaultProps=Bt.defaultProps,Xt.contextType=Ht;var Wt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};class zt extends c.PureComponent{render(){const e=this.props,{children:t}=e,n=Wt(e,["children"]);return c.createElement("text",Object.assign({},n),t)}}zt.defaultProps={className:"react-financial-charts-tooltip",fontFamily:"-apple-system, system-ui, 'Helvetica Neue', Ubuntu, sans-serif",fontSize:11};var Vt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};class $t extends c.PureComponent{render(){const e=this.props,{children:t}=e,n=Vt(e,["children"]);return c.createElement("tspan",Object.assign({},n),t)}}$t.defaultProps={className:"react-financial-charts-tooltip-label",fill:"#4682B4"};class qt extends e.Component{constructor(){super(...arguments),this.renderSVG=this.renderSVG.bind(this)}renderSVG(t){const{accessor:n,changeFormat:r,className:a,displayTexts:s,displayValuesFor:o,fontFamily:i,fontSize:l,fontWeight:c,labelFill:h,labelFontWeight:u,ohlcFormat:d,onClick:p,origin:m,percentFormat:f,textFill:g,volumeFormat:b}=this.props,{chartConfig:{width:y,height:C},fullData:S}=t,w=o(this.props,t),P=null!=w?w:D(S);let E=s.na,x=s.na,k=s.na,A=s.na,M=s.na,T=s.na;if(void 0!==P&&void 0!==n){const e=n(P);void 0!==e&&(E=d(e.open),x=d(e.high),k=d(e.low),A=d(e.close),M=`${r(e.close-e.open)} (${f((e.close-e.open)/e.open)})`,T=b(e.volume))}const[I,_]=v(m)(y,C),O=v(g)(P);return e.createElement("g",{className:a,transform:`translate(${I}, ${_})`,onClick:p},e.createElement(zt,{x:0,y:0,fontFamily:i,fontSize:l,fontWeight:c},e.createElement($t,{fill:h,fontWeight:u,key:"label_O"},s.o),e.createElement("tspan",{key:"value_O",fill:O},E),e.createElement($t,{fill:h,fontWeight:u,key:"label_H"},s.h),e.createElement("tspan",{key:"value_H",fill:O},x),e.createElement($t,{fill:h,fontWeight:u,key:"label_L"},s.l),e.createElement("tspan",{key:"value_L",fill:O},k),e.createElement($t,{fill:h,fontWeight:u,key:"label_C"},s.c),e.createElement("tspan",{key:"value_C",fill:O},A),e.createElement("tspan",{key:"value_Change",fill:O},` ${M}`),e.createElement($t,{fill:h,fontWeight:u,key:"label_V"},s.v),e.createElement("tspan",{key:"value_V",fill:O},T)))}render(){return e.createElement(Xt,{clip:!1,svgDraw:this.renderSVG,drawOn:["mousemove"]})}}qt.propTypes={accessor:t.func,changeFormat:t.func,className:t.string,displayTexts:t.object,displayValuesFor:t.func,fontFamily:t.string,fontSize:t.string,fontWeight:t.number,labelFill:t.string,labelFontWeight:t.number,ohlcFormat:t.func,onClick:t.func,origin:t.array,percentFormat:t.func,textFill:t.func,volumeFormat:t.func},qt.defaultProps={accessor:e=>e,changeFormat:n.format("+.2f"),className:"react-financial-charts-tooltip-hover",displayTexts:{o:"O: ",h:" H: ",l:" L: ",c:" C: ",na:" n/a ",v:"  Vol: "},displayValuesFor:(e,t)=>t.currentItem,fontFamily:"-apple-system, system-ui, 'Helvetica Neue', Ubuntu, sans-serif",fontSize:"12px",fontWeight:300,labelFill:"#9EAAC7",labelFontWeight:300,ohlcFormat:n.format(".2f"),onClick:null,origin:[0,0],percentFormat:n.format("+.2%"),textFill:null,volumeFormat:n.format(".4s")};const Ut={strokeStyle:"#383E55",strokeWidth:2,tickLabelFill:"#9EAAC7",tickStrokeStyle:"#383E55",gridLinesStrokeStyle:"rgba(56, 62, 85, 0.5)"},Zt={fill:"#383E55",textFill:"#FFFFFF"},Gt={fill:"#383E55",fillOpacity:.75,strokeWidth:0,textFill:"#9EAAC7"},Kt={strokeStyle:"#9EAAC7"},Jt=e=>e.close>e.open?"#26a69a":"#ef5350",Qt=e=>{let t,n,{plotData:r}=e;for(const{low:e,high:a}of r)void 0===t&&(t=e),void 0===n&&(n=a),void 0!==e&&t>e&&(t=e),void 0!==a&&n<a&&(n=a);void 0===t&&(t=0),void 0===n&&(n=0);const a=.1*(n-t);return[t-a,n+2*a]},en=e.memo(t=>{let{data:i,dateTimeFormat:l,height:c,margin:u,priceDisplayFormat:d,ratio:p,width:m,axisSettings:f={auto:!0,log:!1,percent:!1},chartType:g="candles"}=t;const[v,b]=e.useState(0);if(!(i&&0!==i.length&&c&&p&&m))return null;const y=e.useMemo(()=>{try{switch(g){case"heikinAshi":return o.heikinAshi()(i);case"renko":return o.renko().options({boxSize:1,sourcePath:"close"})(i);case"kagi":return o.kagi().options({reverseType:"ATR",windowSize:14,reverseValue:2})(i);case"pointFigure":try{const e=o.pointAndFigure().options({boxSize:1,reverseType:"fixed",reverseValue:3,sourcePath:"close"})(i);return console.log("P&F Data structure:",e?.slice(0,2)),e}catch(e){return console.warn("Point & Figure transformation failed:",e),i}default:return i}}catch(e){return console.warn("Data transformation failed for",g,e),i}},[i,g]),C=r.timeFormat(l),S=o.discontinuousTimeScaleProviderBuilder().inputDateAccessor(e=>e.date),{data:w,xScale:P,xAccessor:E,displayXAccessor:x}=S(y),k=e.useMemo(()=>f.log?a.scaleLog():a.scaleLinear(),[f.log]),D=e.useMemo(()=>{if(f.percent&&w.length>0){const e=w[0].close;return t=>{let{plotData:n}=t,r=0,a=0;for(const t of n){const n=(t.close-e)/e*100;r>n&&(r=n),a<n&&(a=n)}const s=.1*Math.abs(a-r);return[r-s,a+s]}}return Qt},[f.percent,w]),A=e.useMemo(()=>f.percent?n.format("+.2f"):d,[f.percent,d]),M=[E(w[Math.max(0,w.length-parseInt(m/5))]),E(w[w.length-1])+1],T=(c-u.top-u.bottom)/5;return e.createElement(o.ChartCanvas,{height:c,ratio:p,width:m,margin:u,seriesName:`Chart ${v}`,data:w,xScale:P,xAccessor:E,displayXAccessor:x,xExtents:M,zoomAnchor:o.lastVisibleItemBasedZoomAnchor},e.createElement(o.Chart,{id:1,height:T,origin:(e,t)=>[0,t-T],yExtents:e=>e.volume},e.createElement(o.BarSeries,{fillStyle:e=>e.close>e.open?"rgba(38, 166, 154, 0.3)":"rgba(239, 83, 80, 0.3)",yAccessor:e=>e.volume})),e.createElement(o.Chart,{id:2,yExtentsCalculator:D,yScale:k},e.createElement(o.XAxis,h({},Ut,{showGridLines:!0})),e.createElement(o.MouseCoordinateX,h({displayFormat:C},Zt)),e.createElement(o.YAxis,h({},Ut,{showGridLines:!0,tickFormat:A})),e.createElement(o.MouseCoordinateY,h({rectWidth:u.right,displayFormat:A},Zt)),e.createElement(o.EdgeIndicator,{itemType:"last",rectWidth:u.right,fill:Jt,lineStroke:Jt,displayFormat:A,yAccessor:e=>e.close}),(()=>{switch(g){case"bars":return e.createElement(o.OHLCSeries,{stroke:Jt,strokeWidth:1});case"candles":default:return e.createElement(o.CandlestickSeries,null);case"hollow":return e.createElement(o.CandlestickSeries,{fill:e=>e.close>e.open?"transparent":Jt(e),stroke:Jt,candleStrokeWidth:1});case"volume":return e.createElement(o.CandlestickSeries,{fill:e=>{const t=Math.max(...i.map(e=>e.volume)),n=Math.min(.8,Math.max(.1,e.volume/t));return`${e.close>e.open?"#26a69a":"#ef5350"}${Math.round(255*n).toString(16).padStart(2,"0")}`},stroke:Jt,candleStrokeWidth:.5});case"line":return e.createElement(o.LineSeries,{yAccessor:e=>e.close,strokeStyle:"#26a69a",strokeWidth:2});case"lineMarkers":return e.createElement(e.Fragment,null,e.createElement(o.LineSeries,{yAccessor:e=>e.close,strokeStyle:"#26a69a",strokeWidth:2}),e.createElement(o.ScatterSeries,{yAccessor:e=>e.close,marker:o.CircleMarker,markerProps:{r:3,fillStyle:"#26a69a",strokeStyle:"#26a69a",strokeWidth:1}}));case"step":return e.createElement(o.LineSeries,{yAccessor:e=>e.close,strokeStyle:"#26a69a",strokeWidth:2,curve:s.curveStepAfter});case"area":return e.createElement(o.AreaSeries,{yAccessor:e=>e.close,strokeStyle:"#26a69a",strokeWidth:2,fillStyle:"rgba(38, 166, 154, 0.2)"});case"hlcArea":return e.createElement(e.Fragment,null,e.createElement(o.AreaOnlySeries,{yAccessor:e=>e.high,base:(e,t)=>e(t.low),fillStyle:"rgba(38, 166, 154, 0.1)"}),e.createElement(o.LineSeries,{yAccessor:e=>e.close,strokeStyle:"#26a69a",strokeWidth:2}));case"baseline":return e.createElement(o.AreaSeries,{yAccessor:e=>e.close,baseAt:e=>e(i[0]?.close||0),strokeStyle:e=>e.close>=i[0]?.close?"#26a69a":"#ef5350",strokeWidth:2,fillStyle:e=>e.close>=i[0]?.close?"rgba(38, 166, 154, 0.2)":"rgba(239, 83, 80, 0.2)"});case"columns":case"range":return e.createElement(o.BarSeries,{yAccessor:e=>e.close,fillStyle:e=>e.close>=i[0]?.close?"#26a69a":"#ef5350",strokeStyle:e=>e.close>=i[0]?.close?"#26a69a":"#ef5350"});case"highLow":return e.createElement(e.Fragment,null,e.createElement(o.OHLCSeries,{strokeWidth:1,stroke:e=>"#9EAAC7",yAccessor:e=>({open:e.high,high:e.high,low:e.low,close:e.high})}),e.createElement(o.ScatterSeries,{yAccessor:e=>e.close,marker:o.CircleMarker,markerProps:{r:3,fillStyle:e=>e.close>=i[0]?.close?"#26a69a":"#ef5350",strokeStyle:e=>e.close>=i[0]?.close?"#26a69a":"#ef5350",strokeWidth:1}}));case"heikinAshi":return e.createElement(o.CandlestickSeries,{fill:e=>e.close>e.open?"#26a69a":"#ef5350",stroke:e=>e.close>e.open?"#26a69a":"#ef5350"});case"renko":return e.createElement(o.RenkoSeries,{fill:{up:"#26a69a",down:"#ef5350",partial:"rgba(38, 166, 154, 0.3)"},stroke:{up:"#26a69a",down:"#ef5350"}});case"kagi":return e.createElement(o.KagiSeries,{stroke:{yang:"#26a69a",yin:"#ef5350"},strokeWidth:2,currentValueStroke:"#9EAAC7"});case"pointFigure":return w&&w.length>0&&w[0].boxes?e.createElement(o.PointAndFigureSeries,{fill:{up:"#26a69a",down:"#ef5350"},stroke:{up:"#26a69a",down:"#ef5350"},strokeWidth:1}):e.createElement(o.CandlestickSeries,{fill:e=>e.close>e.open?"#26a69a":"#ef5350",stroke:e=>e.close>e.open?"#26a69a":"#ef5350"});case"lineBreak":return e.createElement(o.CandlestickSeries,{fill:e=>e.close>e.open?"#26a69a":"#ef5350",stroke:e=>e.close>e.open?"#26a69a":"#ef5350",candleStrokeWidth:1})}})(),e.createElement(qt,{origin:[8,16],textFill:Jt,className:"react-no-select"}),e.createElement(o.ZoomButtons,h({onReset:()=>b(v+1)},Gt))),e.createElement(o.CrossHairCursor,Kt))});en.propTypes={data:t.arrayOf(t.shape({date:t.instanceOf(Date).isRequired,open:t.number.isRequired,high:t.number.isRequired,low:t.number.isRequired,close:t.number.isRequired,volume:t.number.isRequired})).isRequired,dateTimeFormat:t.string,height:t.number,margin:t.object,priceDisplayFormat:t.func,ratio:t.number,width:t.number,axisSettings:t.shape({auto:t.bool,log:t.bool,percent:t.bool}),chartType:t.string},en.defaultProps={dateTimeFormat:"%d %b '%y  %H:%M",height:0,margin:{left:0,right:48,top:0,bottom:24},priceDisplayFormat:n.format(".2f"),ratio:0,width:0};const tn=en,nn=o.withSize({style:{width:"100%",height:"100%"}})(o.withDeviceRatio()(en)),rn={"1 tick":null,"10 ticks":null,"100 ticks":null,"1000 ticks":null,"1 second":1/60,"5 seconds":5/60,"10 seconds":10/60,"15 seconds":.25,"30 seconds":.5,"45 seconds":.75,"1 minute":1,"2 minutes":2,"3 minutes":3,"5 minutes":5,"10 minutes":10,"15 minutes":15,"30 minutes":30,"45 minutes":45,"1 hour":60,"2 hours":120,"3 hours":180,"4 hours":240,"1 day":1440,"1 week":10080,"1 month":43200,"3 months":129600,"6 months":259200,"12 months":525600},an={"1D":1440,"5D":7200,"1M":43200,"3M":129600,"6M":259200,YTD:null,"1Y":525600,"5Y":2628e3,All:null},sn={"1D":1,"5D":5,"1M":30,"3M":90,"6M":180,YTD:null,"1Y":365,"5Y":1825,All:null},on=(e,t)=>{if("YTD"===t||"All"===t)return!0;if(e.includes("tick")||e.includes("range"))return!0;const n=rn[e],r=an[t];return!(!n||!r)&&n<=r},ln=(e,t)=>`Invalid combination: ${e} interval cannot be used with ${t} range. The interval is larger than the time range.`,cn=(e,t)=>{if(!e||0===e.length)return e;const n=e[e.length-1].date;let r;switch(t){case"1D":r=new Date(n.getTime()-864e5);break;case"5D":r=new Date(n.getTime()-432e6);break;case"1M":r=new Date(n.getTime()-2592e6);break;case"3M":r=new Date(n.getTime()-7776e6);break;case"6M":r=new Date(n.getTime()-15552e6);break;case"YTD":r=new Date(n.getFullYear(),0,1);break;case"1Y":r=new Date(n.getTime()-31536e6);break;case"5Y":r=new Date(n.getTime()-15768e7);break;default:return e}return e.filter(e=>e.date>=r)},hn=e=>{const t=e?.full||e;if(!t||"string"!=typeof t)return null;const n=t.match(/^(\d+)\s*(\w+)$/);if(!n)return null;const[,r,a]=n;return{value:parseInt(r),unit:a.toLowerCase()}},un=(e,t)=>{switch(t){case"second":case"seconds":return e/60;case"minute":case"minutes":return e;case"hour":case"hours":return 60*e;case"day":case"days":return 1440*e;case"week":case"weeks":return 10080*e;case"month":case"months":return 43200*e;default:return null}},dn=(e,t)=>{if(t.includes("tick")||t.includes("range"))return!1;const n=hn(e),r=hn(t);if(!n||!r)return!1;const a=un(n.value,n.unit),s=un(r.value,r.unit);return!(!a||!s)&&(s>=a&&s%a===0)},pn=e=>{if(!e||0===e.length)return null;const t=e[0],n=e[e.length-1];let r=t.high,a=t.low,s=0;for(const t of e)t.high>r&&(r=t.high),t.low<a&&(a=t.low),s+=t.volume;return{date:t.date,open:t.open,high:r,low:a,close:n.close,volume:s}},mn=(e,t)=>{if(!e||0===e.length)return e;const n=hn(t);if(!n)return e;const r=un(n.value,n.unit);if(!r)return e;if(r<1)throw new Error(`Cannot transform to ${t}: target interval is smaller than source data resolution`);const a=[];let s=[],o=null;for(const t of e){const e=new Date(t.date);let r;if(n.unit.includes("minute")){r=new Date(e);const t=Math.floor(e.getMinutes()/n.value)*n.value;r.setMinutes(t,0,0)}else if(n.unit.includes("hour")){r=new Date(e);const t=Math.floor(e.getHours()/n.value)*n.value;r.setHours(t,0,0,0)}else if(n.unit.includes("day")){if(r=new Date(e),r.setHours(0,0,0,0),n.value>1){const e=Math.floor(r.getTime()/864e5),t=Math.floor(e/n.value)*n.value;r=new Date(1e3*t*60*60*24)}}else if(n.unit.includes("week")){r=new Date(e);const t=(r.getDay()+6)%7;r.setDate(r.getDate()-t),r.setHours(0,0,0,0)}else if(n.unit.includes("month")){if(r=new Date(e.getFullYear(),e.getMonth(),1),n.value>1){const e=Math.floor(r.getMonth()/n.value)*n.value;r.setMonth(e)}}else r=e;if(null===o||r.getTime()!==o.getTime()){if(s.length>0){const e=pn(s);e&&a.push(e)}s=[t],o=r}else s.push(t)}if(s.length>0){const e=pn(s);e&&a.push(e)}return a},fn=(e,t)=>{if(t.includes("tick"))return"Cannot transform to tick-based intervals. Tick data requires specialized market data.";if(t.includes("range"))return"Cannot transform to range-based intervals. Range data requires specialized market data.";const n=hn(e),r=hn(t);if(!n||!r)return"Invalid interval format.";const a=un(n.value,n.unit),s=un(r.value,r.unit);return a&&s?s<a?`Cannot transform from ${e} to ${t}: target interval is smaller than source data resolution.`:s%a!==0?`Cannot transform from ${e} to ${t}: intervals are not evenly divisible.`:null:"Unsupported time unit."},gn=e.memo(t=>{let{selectedInterval:n="1D",selectedChartType:r="candles",symbolName:a="BTCUSD",symbolIcon:s="",onIntervalChange:o,onChartTypeChange:i,onUndo:l,onRedo:c}=t;const[h,u]=e.useState(!1),[d,p]=e.useState(!1),m=e.useRef(null),f=e.useRef(null);e.useEffect(()=>{const e=e=>{m.current&&!m.current.contains(e.target)&&u(!1),f.current&&!f.current.contains(e.target)&&p(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const g={TICKS:[{full:"1 tick",short:"1t"},{full:"10 ticks",short:"10t"},{full:"100 ticks",short:"100t"},{full:"1000 ticks",short:"1000t"}],SECONDS:[{full:"1 second",short:"1s"},{full:"5 seconds",short:"5s"},{full:"10 seconds",short:"10s"},{full:"15 seconds",short:"15s"},{full:"30 seconds",short:"30s"},{full:"45 seconds",short:"45s"}],MINUTES:[{full:"1 minute",short:"1m"},{full:"2 minutes",short:"2m"},{full:"3 minutes",short:"3m"},{full:"5 minutes",short:"5m"},{full:"10 minutes",short:"10m"},{full:"15 minutes",short:"15m"},{full:"30 minutes",short:"30m"},{full:"45 minutes",short:"45m"}],HOURS:[{full:"1 hour",short:"1H"},{full:"2 hours",short:"2H"},{full:"3 hours",short:"3H"},{full:"4 hours",short:"4H"}],DAYS:[{full:"1 day",short:"1D"},{full:"1 week",short:"1W"},{full:"1 month",short:"1M"},{full:"3 months",short:"3M"},{full:"6 months",short:"6M"},{full:"12 months",short:"12M"}],RANGES:[{full:"1 range",short:"1R"},{full:"10 ranges",short:"10R"},{full:"100 ranges",short:"100R"},{full:"1000 ranges",short:"1000R"}]},v=[{id:"bars",label:"Bars",icon:"Bars"},{id:"candles",label:"Candles",icon:"Candlestick"},{id:"hollow",label:"Hollow candles",icon:"HollowCandles"},{id:"volume",label:"Volume candles",icon:"VolumeCandles"},{type:"separator"},{id:"line",label:"Line",icon:"Lines"},{id:"lineMarkers",label:"Line with markers",icon:"LineMarkers"},{id:"step",label:"Step line",icon:"StepLine"},{type:"separator"},{id:"area",label:"Area",icon:"Area"},{id:"hlcArea",label:"HLC area",icon:"HLCArea"},{id:"baseline",label:"Baseline",icon:"Baseline"},{type:"separator"},{id:"columns",label:"Columns",icon:"Columns"},{id:"highLow",label:"High-low",icon:"HighLow"},{type:"separator"},{id:"volumeFootprint",label:"Volume footprint",icon:"VolumeFootprint"},{id:"timePriceOpportunity",label:"Time Price Opportunity",icon:"TimePriceOpportunity"},{id:"sessionVolume",label:"Session volume profile",icon:"SessionVolumeProfile"},{type:"separator"},{id:"heikinAshi",label:"Heikin Ashi",icon:"HeikinAshi"},{id:"renko",label:"Renko",icon:"Renko"},{id:"lineBreak",label:"Line break",icon:"LineBreak"},{id:"kagi",label:"Kagi",icon:"Kagi"},{id:"pointFigure",label:"Point & figure",icon:"PointAndFigure"},{id:"range",label:"Range",icon:"Range"}],b=e=>{switch(e){case"undo":l?l():alert("Undo not implemented");break;case"redo":c?c():alert("Redo not implemented");break;case"indicators":alert("Indicators not implemented");break;case"alert":alert("Alert not implemented");break;case"replay":alert("Replay not implemented");break;default:alert(`${e} not implemented`)}};return e.createElement("div",{className:"topbar"},e.createElement("div",{className:"topbar-left"},e.createElement("div",{className:"topbar-symbol"},e.createElement("span",{className:"symbol-icon"},s),e.createElement("span",{className:"symbol-name"},a)),e.createElement("div",{className:"topbar-divider"}),e.createElement("div",{className:"interval-selector",ref:m},e.createElement("button",{className:"interval-button",onClick:()=>u(!h)},(()=>{if("string"==typeof n){for(const e of Object.values(g))for(const t of e)if(t.full===n)return t.short;return n}return n?.short||n})()),h&&e.createElement("div",{className:"interval-menu"},Object.entries(g).map(t=>{let[r,a]=t;return e.createElement("div",{key:r,className:"interval-category"},e.createElement("div",{className:"interval-category-header"},r),a.map(t=>e.createElement("button",{key:t.full,className:"interval-item "+((n?.full||n)===t.full?"active":""),onClick:()=>(e=>{u(!1),o?o(e):alert(`Interval change to ${e.full} not implemented`)})(t)},t.full)))}))),e.createElement("div",{className:"topbar-divider"}),e.createElement("div",{className:"chart-type-selector",ref:f},e.createElement("button",{className:"chart-type-button",onClick:()=>p(!d)},e.createElement("img",{src:`/TradingViewIcons/${v.find(e=>e.id===r)?.icon||"Candlestick"}.svg`,alt:"Chart type",width:"24",height:"24"})),d&&e.createElement("div",{className:"chart-type-menu"},v.map((t,n)=>"separator"===t.type?e.createElement("div",{key:`separator-${n}`,className:"chart-type-separator"}):e.createElement("button",{key:t.id,className:"chart-type-item "+(t.id===r?"active":""),onClick:()=>(e=>{p(!1),i?i(e.id):alert(`Chart type change to ${e.label} not implemented`)})(t)},e.createElement("img",{src:`/TradingViewIcons/${t.icon}.svg`,alt:t.label,width:"24",height:"24"}),e.createElement("span",null,t.label))))),e.createElement("div",{className:"topbar-divider"}),e.createElement("button",{className:"topbar-icon-btn",onClick:()=>b("indicators"),title:"Indicators"},e.createElement("img",{src:"/TradingViewIcons/Indicator.svg",alt:"Indicators",width:"24",height:"24"}),e.createElement("span",{className:"btn-label"},"Indicators")),e.createElement("div",{className:"topbar-divider"}),e.createElement("button",{className:"topbar-icon-btn",onClick:()=>b("alert"),title:"Alert"},e.createElement("img",{src:"/TradingViewIcons/Target.svg",alt:"Alert",width:"24",height:"24"}),e.createElement("span",{className:"btn-label"},"Alert")),e.createElement("button",{className:"topbar-icon-btn",onClick:()=>b("replay"),title:"Replay"},e.createElement("img",{src:"/TradingViewIcons/Rewind.svg",alt:"Replay",width:"24",height:"24"}),e.createElement("span",{className:"btn-label"},"Replay")),e.createElement("div",{className:"topbar-divider"}),e.createElement("button",{className:"topbar-icon-btn",onClick:()=>b("undo"),title:"Undo"},e.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},e.createElement("path",{d:"M6 12h10a4 4 0 0 1 0 8M6 12l3-3M6 12l3 3",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}))),e.createElement("button",{className:"topbar-icon-btn",onClick:()=>b("redo"),title:"Redo"},e.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},e.createElement("path",{d:"M18 12H8a4 4 0 0 0 0 8M18 12l-3-3M18 12l-3 3",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})))),e.createElement("div",{className:"topbar-right"},e.createElement("div",{className:"price-info"},e.createElement("span",{className:"price-open"},"O 117,485.1"),e.createElement("span",{className:"price-high"},"H 119,519.8"),e.createElement("span",{className:"price-low"},"L 117,278.6"),e.createElement("span",{className:"price-close"},"C 119,419.4"),e.createElement("span",{className:"price-change positive"},"+1,966.6 (+1.67%)"))))}),vn=e.memo(()=>{const[t,n]=e.useState(null),[r,a]=e.useState("cursor"),s=e.useRef(null);e.useEffect(()=>{const e=e=>{s.current&&!s.current.contains(e.target)&&n(null)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const o=[{category:"LINES",items:[{id:"trendLine",icon:"TrendLine",label:"Trend Line"},{id:"ray",icon:"Ray",label:"Ray"},{id:"infoLine",icon:"InfoLine",label:"Info Line"},{id:"extendedLine",icon:"ExtendedLine",label:"Extended Line"},{id:"trendAngle",icon:"TrendAngle",label:"Trend Angle"},{id:"horizontalLine",icon:"HorizontalLine",label:"Horizontal Line"},{id:"horizontalRay",icon:"HorizontalRay",label:"Horizontal Ray"},{id:"verticalLine",icon:"VerticalLine",label:"Vertical Line"},{id:"crossLine",icon:"CrossLine",label:"Cross Line"}]},{category:"CHANNELS",items:[{id:"parallelChannel",icon:"ParallelChannel",label:"Parallel Channel"},{id:"regressionTrend",icon:"RegressionTrend",label:"Regression Trend"},{id:"flatTopBottom",icon:"FlatTopBottom",label:"Flat Top/Bottom"},{id:"disjointChannel",icon:"DisjointChannel",label:"Disjoint Channel"}]},{category:"PITCHFORKS",items:[{id:"pitchfork",icon:"Pitchfork",label:"Pitchfork"},{id:"schiffPitchfork",icon:"SchiffPitchfork",label:"Schiff Pitchfork"},{id:"modifiedSchiff",icon:"ModifiedSchiffPitchfork",label:"Modified Schiff Pitchfork"},{id:"insidePitchfork",icon:"InsidePitchfork",label:"Inside Pitchfork"}]}],i=[{id:"fibRetracement",icon:"Fibbinoci",label:"Fib Retracement"},{id:"fibExtension",icon:"Trend-BasedFibExtension",label:"Trend-Based Fib Extension"},{id:"fibSpeedFan",icon:"FibSpeedResistanceFan",label:"Fib Speed Resistance Fan"},{id:"fibTimezone",icon:"FibTimeZone",label:"Fib Timezone"},{id:"fibCircles",icon:"FibCircles",label:"Fib Circles"},{id:"fibSpiral",icon:"FibSpiral",label:"Fib Spiral"},{id:"fibChannel",icon:"FibChannel",label:"Fib Channel"},{id:"fibWedge",icon:"FibWedge",label:"Fib Wedge"}],l=[{category:"BRUSHES",items:[{id:"brush",icon:"Brush",label:"Brush"},{id:"highlighter",icon:"Highlighter",label:"Highlighter"}]},{category:"ARROWS",items:[{id:"arrowMarker",icon:"ArrowMarker",label:"Arrow Marker"},{id:"arrow",icon:"Arrow",label:"Arrow"},{id:"arrowUp",icon:"ArrowMarkUp",label:"Arrow Mark Up"},{id:"arrowDown",icon:"ArrowMarkDown",label:"Arrow Mark Down"}]},{category:"SHAPES",items:[{id:"rectangle",icon:"Rectangle",label:"Rectangle"},{id:"rotatedRectangle",icon:"RotatedRectangle",label:"Rotated Rectangle"},{id:"path",icon:"Path",label:"Path"},{id:"circle",icon:"Circle",label:"Circle"},{id:"ellipse",icon:"Ellipse",label:"Ellipse"},{id:"polyline",icon:"Polyline",label:"Polyline"},{id:"triangle",icon:"Triangle",label:"Triangle"},{id:"arc",icon:"Arc",label:"Arc"},{id:"curve",icon:"Curve",label:"Curve"}]}],c=e=>{a(e.id),n(null),alert(`${e.label} not implemented`)};return e.createElement("div",{className:"left-sidebar",ref:s},e.createElement("div",{className:"sidebar-tools"},[{id:"cursor",icon:"CrossLine",label:"Cross Cursor"},{id:"trend",icon:"TrendLine",label:"Trend Line Tools",hasSubmenu:!0},{id:"fibonacci",icon:"Fibbinoci",label:"Fibonacci Tools",hasSubmenu:!0},{id:"patterns",icon:"TrianglePattern",label:"Patterns",hasSubmenu:!0},{id:"forecast",icon:"Forecast",label:"Forecast Tools",hasSubmenu:!0},{id:"measure",icon:"Ruler",label:"Measure Tools",hasSubmenu:!0},{id:"annotation",icon:"Text",label:"Annotation Tools",hasSubmenu:!0},{id:"icons",icon:"FlagMark",label:"Icons",hasSubmenu:!0},{id:"volume",icon:"VolumeCandles",label:"Volume Profile Tools",hasSubmenu:!0},{id:"search",icon:"Search",label:"Search"},{id:"magnet",icon:"Magnet",label:"Magnet Mode"},{id:"drawing-lock",icon:"Unlock",label:"Drawing Lock"},{id:"hide-drawings",icon:"EyePaint",label:"Hide All Drawings"},{id:"remove-drawings",icon:"Trash",label:"Remove All Drawings"}].map(s=>e.createElement("button",{key:s.id,className:"sidebar-tool "+(r===s.id||t===s.id?"active":""),onClick:()=>(e=>{e.hasSubmenu?n(t===e.id?null:e.id):(a(e.id),n(null),["cursor","magnet","drawing-lock","hide-drawings","remove-drawings","search"].includes(e.id)||alert(`${e.label} tool not implemented`))})(s),title:s.label},e.createElement("img",{src:`/TradingViewIcons/${s.icon}.svg`,alt:s.label,width:"24",height:"24"}),s.hasSubmenu&&e.createElement("span",{className:"submenu-indicator"},"")))),t&&(()=>{switch(t){case"trend":return e.createElement("div",{className:"submenu"},o.map(t=>e.createElement("div",{key:t.category,className:"submenu-category"},e.createElement("div",{className:"submenu-category-header"},t.category),t.items.map(t=>e.createElement("button",{key:t.id,className:"submenu-item "+(r===t.id?"active":""),onClick:()=>c(t)},e.createElement("img",{src:`/TradingViewIcons/${t.icon}.svg`,alt:t.label,width:"20",height:"20"}),e.createElement("span",null,t.label))))));case"fibonacci":return e.createElement("div",{className:"submenu"},i.map(t=>e.createElement("button",{key:t.id,className:"submenu-item "+(r===t.id?"active":""),onClick:()=>c(t)},e.createElement("img",{src:`/TradingViewIcons/${t.icon}.svg`,alt:t.label,width:"16",height:"16"}),e.createElement("span",null,t.label))));case"annotation":return e.createElement("div",{className:"submenu"},l.map(t=>e.createElement("div",{key:t.category,className:"submenu-category"},e.createElement("div",{className:"submenu-category-header"},t.category),t.items.map(t=>e.createElement("button",{key:t.id,className:"submenu-item "+(r===t.id?"active":""),onClick:()=>c(t)},e.createElement("img",{src:`/TradingViewIcons/${t.icon}.svg`,alt:t.label,width:"20",height:"20"}),e.createElement("span",null,t.label))))));default:return null}})())}),bn=e.memo(t=>{let{selectedInterval:n={full:"1 day",short:"1D"},selectedRange:r="All",onAxisSettingChange:a,onRangeChange:s}=t;const[o,i]=e.useState(new Date),[l,c]=e.useState({auto:!0,log:!1,percent:!1});e.useEffect(()=>{const e=setInterval(()=>{i(new Date)},1e3);return()=>clearInterval(e)},[]);const h=e=>{const t={...l};"auto"===e?t.auto=!l.auto:"log"===e?(t.log=!l.log,t.log&&(t.percent=!1)):"percent"===e&&(t.percent=!l.percent,t.percent&&(t.log=!1)),c(t),a&&a(e,t)},u=e=>{const t=((e,t)=>{if(e.includes("tick")){const n=sn[t];if(!n)return null;const r=1e3*n,a=parseInt(e.split(" ")[0]);return Math.floor(r/a)}if(e.includes("range")){const n=sn[t];if(!n)return null;const r=100*n,a=parseInt(e.split(" ")[0]);return Math.floor(r/a)}const n=rn[e],r=an[t];return n&&r?Math.floor(r/n):null})(n?.full||n,e);return t},d=e=>!on(n?.full||n,e),p=e=>{alert(`${e} not implemented`)};return e.createElement("div",{className:"footer-bar"},e.createElement("div",{className:"footer-left"},["1D","5D","1M","3M","6M","YTD","1Y","5Y","All"].map(t=>e.createElement("button",{key:t,className:`range-button ${r===t?"active":""} ${d(t)?"disabled":""}`,onClick:()=>(e=>{const t=n?.full||n;on(t,e)?s&&s(e):alert(ln(t,e))})(t),disabled:d(t),title:d(t)?ln(n?.full||n,t):`${u(t)} candles`},t))),e.createElement("div",{className:"footer-center"},e.createElement("div",{className:"tradingview-watermark"},e.createElement("img",{src:"/TradingViewIcons/Network.svg",alt:"TradingView",width:"18",height:"18"}),e.createElement("span",null,"TradingView"))),e.createElement("div",{className:"footer-right"},e.createElement("div",{className:"axis-settings"},e.createElement("button",{className:"axis-button "+(l.auto?"active":""),onClick:()=>h("auto"),title:"Auto (fits data to screen)"},"Auto"),e.createElement("button",{className:"axis-button "+(l.log?"active":""),onClick:()=>h("log"),title:"Log Scale"},"Log"),e.createElement("button",{className:"axis-button "+(l.percent?"active":""),onClick:()=>h("percent"),title:"Percentage"},"%")),e.createElement("div",{className:"footer-divider"}),e.createElement("button",{className:"footer-icon-btn",onClick:()=>p("screenshot"),title:"Take a snapshot"},e.createElement("img",{src:"/TradingViewIcons/Camera.svg",alt:"Screenshot",width:"18",height:"18"})),e.createElement("button",{className:"footer-icon-btn",onClick:()=>p("settings"),title:"Settings"},e.createElement("img",{src:"/TradingViewIcons/Nut.svg",alt:"Settings",width:"18",height:"18"})),e.createElement("div",{className:"footer-divider"}),e.createElement("div",{className:"current-time"},o.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})+" UTC")))}),yn=e.memo(t=>{let{data:n,loaded:r,axisSettings:a,error:s,chartType:o}=t;return e.createElement("div",{className:"chart-container"},s?e.createElement("div",{className:"error-message"},e.createElement("h3",null,"Data Transformation Error"),e.createElement("p",null,s),e.createElement("p",null,"Please select a different interval or check your data source.")):r&&n?e.createElement(nn,{data:n,axisSettings:a,chartType:o}):r&&!n?e.createElement("div",{className:"error-message"},e.createElement("p",null,"No data available for the selected time range and interval.")):e.createElement("div",{className:"loading-message"},"Loading market data..."))}),Cn=t=>{let{data:n,dataInterval:r="1 minute",symbolName:a="SYMBOL",symbolIcon:s="",defaultInterval:o={full:"1 minute",short:"1m"},defaultChartType:i="candles",defaultRange:l="All",showTopBar:c=!0,showLeftSidebar:h=!0,showFooterBar:u=!0,onIntervalChange:d,onChartTypeChange:p,onRangeChange:m,onAxisSettingChange:f,className:g=""}=t;const[v,b]=e.useState(o),[y,C]=e.useState(i),[S,w]=e.useState({auto:!0,log:!1,percent:!1}),[P,E]=e.useState(l),[x,k]=e.useState(null),D=e.useMemo(()=>{if(!n)return null;try{k(null);const e=v?.full||v;if(!dn(r,e)){const t=fn(r,e);return k(t),null}let t;try{t=mn(n,e)}catch(e){return k(e.message),null}return cn(t,P)}catch(e){return console.error("Data processing error:",e),k("Failed to process data"),null}},[n,v,P,r]),A=e.useCallback(e=>{b(e),d&&d(e)},[d]),M=e.useCallback(e=>{C(e),p&&p(e)},[p]),T=e.useCallback((e,t)=>{w(t),f&&f(e,t)},[f]),I=e.useCallback(e=>{E(e),m&&m(e)},[m]);return e.createElement("div",{className:`app-container ${g}`},c&&e.createElement(gn,{selectedInterval:v,selectedChartType:y,symbolName:a,symbolIcon:s,onIntervalChange:A,onChartTypeChange:M}),e.createElement("div",{className:"app-content"},h&&e.createElement(vn,null),e.createElement(yn,{data:x?null:D,loaded:!0,axisSettings:S,error:x,chartType:y})),u&&e.createElement(bn,{selectedInterval:v,selectedRange:P,onAxisSettingChange:T,onRangeChange:I}))};Cn.propTypes={data:t.arrayOf(t.shape({date:t.instanceOf(Date).isRequired,open:t.number.isRequired,high:t.number.isRequired,low:t.number.isRequired,close:t.number.isRequired,volume:t.number.isRequired})).isRequired,dataInterval:t.string,symbolName:t.string,symbolIcon:t.string,defaultInterval:t.oneOfType([t.string,t.shape({full:t.string.isRequired,short:t.string.isRequired})]),defaultChartType:t.string,defaultRange:t.string,showTopBar:t.bool,showLeftSidebar:t.bool,showFooterBar:t.bool,onIntervalChange:t.func,onChartTypeChange:t.func,onRangeChange:t.func,onAxisSettingChange:t.func,className:t.string};const Sn=r.timeParse("%Y-%m-%d");exports.CHART_TYPES={CANDLES:"candles",BARS:"bars",HOLLOW:"hollow",VOLUME:"volume",LINE:"line",LINE_MARKERS:"lineMarkers",STEP:"step",AREA:"area",HLC_AREA:"hlcArea",BASELINE:"baseline",COLUMNS:"columns",HIGH_LOW:"highLow",HEIKIN_ASHI:"heikinAshi",RENKO:"renko",KAGI:"kagi",POINT_FIGURE:"pointFigure",LINE_BREAK:"lineBreak",RANGE:"range"},exports.FooterBar=bn,exports.INTERVALS=[{full:"1 second",short:"1s"},{full:"5 seconds",short:"5s"},{full:"10 seconds",short:"10s"},{full:"15 seconds",short:"15s"},{full:"30 seconds",short:"30s"},{full:"1 minute",short:"1m"},{full:"2 minutes",short:"2m"},{full:"3 minutes",short:"3m"},{full:"5 minutes",short:"5m"},{full:"10 minutes",short:"10m"},{full:"15 minutes",short:"15m"},{full:"30 minutes",short:"30m"},{full:"1 hour",short:"1h"},{full:"2 hours",short:"2h"},{full:"3 hours",short:"3h"},{full:"4 hours",short:"4h"},{full:"6 hours",short:"6h"},{full:"8 hours",short:"8h"},{full:"12 hours",short:"12h"},{full:"1 day",short:"1d"},{full:"3 days",short:"3d"},{full:"1 week",short:"1w"},{full:"1 month",short:"1M"}],exports.LeftSidebar=vn,exports.OHLCTooltip=qt,exports.PriceChart=nn,exports.PriceChartBase=tn,exports.TIME_RANGES=["1D","5D","1M","3M","6M","YTD","1Y","5Y","All"],exports.TopBar=gn,exports.TradingChart=Cn,exports.canTransformData=dn,exports.filterDataByRange=cn,exports.getTransformationError=fn,exports.transformDataToInterval=mn,exports.useMarketData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"MINUTES",n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[r,a]=e.useState(),[s,o]=e.useState(500);return e.useEffect(()=>{r||fetch(`https://raw.githubusercontent.com/reactivemarkets/react-financial-charts/master/packages/stories/src/data/${t}.tsv`).then(e=>e.text()).then(e=>i.tsvParse(e,e=>{const t=Sn(e.date);e.date=t?new Date(t):new Date(Number(e.date));for(const t in e)"date"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&(e[t]=+e[t]);return e})).then(e=>{a(e)})},[r,t,a]),((t,n)=>{const r=e.useRef(null),a=e.useRef(t);e.useEffect(()=>{a.current=t},[t]),e.useEffect(()=>{const e=()=>a.current();return r.current=window.setInterval(e,n),()=>window.clearInterval(r.current)},[n])})(()=>{r&&n&&o(s+1)},1e3),{data:n?r?.slice(0,s+1):r,loaded:Boolean(r)}};
//# sourceMappingURL=index.js.map
